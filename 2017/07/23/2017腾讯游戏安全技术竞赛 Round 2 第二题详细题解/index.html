<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  
  <title>2017腾讯游戏安全技术竞赛 Round 2 第二题详细题解 | Ericky1992</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
    <meta name="author" content="The darkness is no darkness with thee.">
  
  
    <meta name="description" content="前言第二题如果说就让人望而却步的话，这道题怕是要让人吐血身亡了。自己写wp感觉也要写得头发掉光，非常慌。不过既然到了最后一题，为了完整性，硬着头皮也得做下来吧，打开程序一开，里面有dll，采用的是mono框架，是不折不扣的.net的程序。我是第一次接触.net，更别说里面的IL code，jit什么的妖魔鬼怪了，反正现学现卖，不过鬼怪见多了也就慢慢习惯它们的样子了，慢慢就适应了，呃。我还是选择的安">
  
  <meta name="description" content="前言第二题如果说就让人望而却步的话，这道题怕是要让人吐血身亡了。自己写wp感觉也要写得头发掉光，非常慌。不过既然到了最后一题，为了完整性，硬着头皮也得做下来吧，打开程序一开，里面有dll，采用的是mono框架，是不折不扣的.net的程序。我是第一次接触.net，更别说里面的IL code，jit什么的妖魔鬼怪了，反正现学现卖，不过鬼怪见多了也就慢慢习惯它们的样子了，慢慢就适应了，呃。我还是选择的安">
<meta property="og:type" content="article">
<meta property="og:title" content="2017腾讯游戏安全技术竞赛 Round 2 第二题详细题解">
<meta property="og:url" content="http://yoursite.com/2017/07/23/2017腾讯游戏安全技术竞赛 Round 2 第二题详细题解/index.html">
<meta property="og:site_name" content="Ericky1992">
<meta property="og:description" content="前言第二题如果说就让人望而却步的话，这道题怕是要让人吐血身亡了。自己写wp感觉也要写得头发掉光，非常慌。不过既然到了最后一题，为了完整性，硬着头皮也得做下来吧，打开程序一开，里面有dll，采用的是mono框架，是不折不扣的.net的程序。我是第一次接触.net，更别说里面的IL code，jit什么的妖魔鬼怪了，反正现学现卖，不过鬼怪见多了也就慢慢习惯它们的样子了，慢慢就适应了，呃。我还是选择的安">
<meta property="og:updated_time" content="2017-08-28T13:07:25.564Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2017腾讯游戏安全技术竞赛 Round 2 第二题详细题解">
<meta name="twitter:description" content="前言第二题如果说就让人望而却步的话，这道题怕是要让人吐血身亡了。自己写wp感觉也要写得头发掉光，非常慌。不过既然到了最后一题，为了完整性，硬着头皮也得做下来吧，打开程序一开，里面有dll，采用的是mono框架，是不折不扣的.net的程序。我是第一次接触.net，更别说里面的IL code，jit什么的妖魔鬼怪了，反正现学现卖，不过鬼怪见多了也就慢慢习惯它们的样子了，慢慢就适应了，呃。我还是选择的安">
  
  
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <div class="wrapper">
    <header id="header">
  <div class="title">
    <h1><a href="/">Ericky1992</a></h1>
    <p><a href="/">pursue ceaselessly</a></p>
  </div>
  <nav class="nav">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/">About</a></li>
      
      
    </ul>
    <div class="clearfix"></div>
  </nav>
  <div class="clearfix"></div>
</header>
    <div class="content"><article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2017/07/23/2017腾讯游戏安全技术竞赛 Round 2 第二题详细题解/">
  <time datetime="2017-07-23T15:00:00.000Z">
    2017-07-23
  </time>
</a>
    
    
  
    <h1 class="title">2017腾讯游戏安全技术竞赛 Round 2 第二题详细题解</h1>
  

  </header>
  
  <div class="entry">
    
      <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>第二题如果说就让人望而却步的话，这道题怕是要让人吐血身亡了。自己写wp感觉也要写得头发掉光，非常慌。不过既然到了最后一题，为了完整性，硬着头皮也得做下来吧，打开程序一开，里面有dll，采用的是mono框架，是不折不扣的.net的程序。我是第一次接触.net，更别说里面的IL code，jit什么的妖魔鬼怪了，反正现学现卖，不过鬼怪见多了也就慢慢习惯它们的样子了，慢慢就适应了，呃。我还是选择的安卓平台的题目，从评分标准来看，这个题目就分为了3小问，所以我把这个题目分为三大部分，一一阐述每个部分。</p>
<h3 id="0x1-多战寻路–寻到一个坑"><a href="#0x1-多战寻路–寻到一个坑" class="headerlink" title="0x1 多战寻路–寻到一个坑"></a>0x1 多战寻路–寻到一个坑</h3><p>正如标题所说，三战寻路–寻到一个坑。本来ida里的函数多数都被我标记得差不多了，因为用IDA F9动态调试的缘故，函数名都丢了(这里我曾崩溃)，凑合着看吧，请见谅。<br>先贴一个main函数：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">signed int sub_9EC0()</div><div class="line">&#123;</div><div class="line">  int v0; // r0@1</div><div class="line">  char *v1; // r3@1</div><div class="line">  int v2; // r7@1</div><div class="line">  int v3; // r0@3</div><div class="line">  int v4; // r4@3</div><div class="line">  int v5; // r8@3</div><div class="line">  int v6; // r0@6</div><div class="line">  int v7; // r5@6</div><div class="line">  int v8; // r6@7</div><div class="line">  int v9; // r1@7</div><div class="line">  int v10; // r0@7</div><div class="line">  signed int result; // r0@8</div><div class="line">  char v12; // [sp+8h] [bp-20h]@1</div><div class="line">  int v13; // [sp+Ch] [bp-1Ch]@1</div><div class="line"></div><div class="line">  pthread_create(&amp;v12);</div><div class="line">  v13 = 3;</div><div class="line">  sub_6C130(&amp;unk_2B4E38, 0);</div><div class="line">  v0 = sub_A5B4(&amp;unk_2B4E3A);</div><div class="line">  v1 = &amp;byte_36F000;</div><div class="line">  v2 = v0;</div><div class="line">  do</div><div class="line">  &#123;</div><div class="line">    *v1 = ~(*v1 ^ 0x11);</div><div class="line">    ++v1;</div><div class="line">  &#125;</div><div class="line">  while ( (_UNKNOWN *)v1 != &amp;unk_370200 );</div><div class="line">  v3 = sub_B925C(&amp;byte_36F000, 4608, 1, &amp;v13, 0, &amp;unk_2B4E3A);</div><div class="line">  v4 = v13;</div><div class="line">  v5 = v3;</div><div class="line">  <span class="keyword">if</span> ( !v13</div><div class="line">    &amp;&amp; v3</div><div class="line">    &amp;&amp; sub_6F0A4(v3, &amp;unk_2B4E3A)</div><div class="line">    &amp;&amp; (v6 = sub_86FB0(v5, <span class="string">"encrypt"</span>, <span class="string">"Hello"</span>), (v7 = v6) != <span class="number">0</span>)</div><div class="line">    &amp;&amp; (v8 = sub_1196BC(v2, v6), sub_10FA38(v8, v9), (v10 = sub_898DC(v7, <span class="string">"SayHello"</span>, v4)) != <span class="number">0</span>) )</div><div class="line">  &#123;</div><div class="line">    sub_116D20(v10, v8, v4, v4);</div><div class="line">    sub_B9988(v5);</div><div class="line">    result = v4;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span></div><div class="line">  &#123;</div><div class="line">    result = 1;</div><div class="line">  &#125;</div><div class="line">  return result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Bypass反调试"><a href="#Bypass反调试" class="headerlink" title="Bypass反调试"></a>Bypass反调试</h3><p>说一下反调试先，我一共发现两处。init_array段有一处反调是，虽然不知道怎么判断的，反正把exit nop掉就行了。然后在main函数的起始位置起了一个反调试的线程，把启动的内容nop掉就可以了，这样就可以调试了，也就是可以正式开始漫漫长征路。</p>
<h3 id="主程序流程"><a href="#主程序流程" class="headerlink" title="主程序流程"></a>主程序流程</h3><p>先分析一下程序的流程，程序开始会释放一个4.5kb的dll，称之为关键dll，然后通过mono框架加载这个dll 以及在外面的mscorlib.dll，调用mono框架中的一系列函数，寻找到指定的类，再找到sayhello函数，最后调用method_runtime_invoke，print出hello 。</p>
<h3 id="初步修复关键dll"><a href="#初步修复关键dll" class="headerlink" title="初步修复关键dll"></a>初步修复关键dll</h3><p>先不管那么多，既然它偷偷的加载dll，直接dump出来看看再说。dump出来的dll为非法文件，使用010editor 已经跟踪代码发现几处问题，Patch了5字节，至少成为了一个看起来正常的dll。<br>问题1.<br>5字节之第1字节：PE文件的签名，正常的pe文件签名位PE00，而这个文件的签名为PE01，这会导致NT头找不到，无法被正常识别。<br>原因：通过跟踪代码可以知道，mono框架只检查了PE，没有检查后面的00是否正确。<br>附上一个pe文件格式链接：<br><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms680547(v=vs.85).aspx#other_contents_of_the_file" target="_blank" rel="external">https://msdn.microsoft.com/en-us/library/windows/desktop/ms680547(v=vs.85).aspx#other_contents_of_the_file</a></p>
<p>5字节之第2字节：.net程序里面有一项叫做元数据流，附上链接：<br><a href="http://www.cnblogs.com/ShaYeBlog/archive/2013/07/20/3202191.html" target="_blank" rel="external">http://www.cnblogs.com/ShaYeBlog/archive/2013/07/20/3202191.html</a><br>导致dll继续报错的原因是一个#String的堆，未能识别，导致后面一系列失败，将后面的00 patch成 73即可。<br>原因：找到解析元数据中堆的地方，贴代码如下：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">else</span> <span class="keyword">if</span> ( !strncmp(v22 + <span class="number">8</span>, <span class="string">"#Strings"</span>, <span class="number">7</span>u) )</div><div class="line">       &#123;</div><div class="line">         v8 = *(_DWORD *)(v15 + 52);</div><div class="line">         *(_DWORD *)(v15 + 56) = v8 + read32(v22);</div><div class="line">         *(_DWORD *)(v15 + 60) = read32(v22 + 4);</div><div class="line">         v22 += 17;</div><div class="line">       &#125;</div><div class="line">       <span class="keyword">else</span> <span class="keyword">if</span> ( !strncmp(v22 + <span class="number">8</span>, <span class="string">"#US"</span>, <span class="number">4</span>u) )</div></pre></td></tr></table></figure>
<p>可以看到，”s”字节没有比较，从这里可以看出来这个mono框架被修改过，而且有点猥琐。而在正常的mono框架中，strncmp的是9位，这就是元数据流异常的原因。</p>
<p>5字节之后3字节：<br>都在解析和装在MetaData的过程中，有3处高位被改了，导致一般的工具报数组越界的错误。<br>原因：mono框架修改了read函数，在read的时候只取了低位，这样的话不影响它自身对dll的解析。</p>
<p>修复这5字节，大概dll可以算得上“正常”了，至少扔到反编译工具中不出错了。</p>
<h3 id="三寻IL-code-真身"><a href="#三寻IL-code-真身" class="headerlink" title="三寻IL code 真身"></a>三寻IL code 真身</h3><p>第一寻<br>一开始没想太多，想的就是可能在loadtable的时候把IL code还原了，然后追踪了很多遍，并没有发现真正的IL code，这里被坑了。局面开始显得僵化，突然发现这样的一个文章：<br><a href="http://www.cnblogs.com/northstarlight/archive/2010/07/04/1771021.html" target="_blank" rel="external">http://www.cnblogs.com/northstarlight/archive/2010/07/04/1771021.html</a><br>以为是隐藏IL code，加了壳，于是就开始了漫漫长路第二寻</p>
<p>第二寻<br>既然是壳，总会解密，继续跟就行了，外面既然没修改IL code的话，那肯定在更底层了。为了方便调试跟踪以及分析，我把源码下载下来了，地址在这：<br><a href="https://github.com/mono/mono" target="_blank" rel="external">https://github.com/mono/mono</a><br>然后就变成了苦逼的阅读代码，好，突然发现一个函数，mono_jit_compile_method_with_opt，再跟到mono_jit_compile_method_inner，再跟到mini_method_compile，再跟到mono_runtime_invoke，sayhello都已经执行了，我并没有定位到恢复的IL code，又过了不久，开始第三寻。</p>
<p>第三寻<br>直接定位mono_method_to_ir，这是最底层解析IL opcode的函数了，我在这下断点跟踪，总能搞定吧。这个函数也是够大，20000行，摘出来，一点一点看，一直跟不到修改IL code 的地方，最后发现，这个函数出题方居然动了，居然用自己的一套来解析Opcode，难怪dll中的IL code乱七八糟也能被执行，终于找到原因了，剩下的就是人肉还原IL code了。</p>
<h3 id="人肉还原IL-code"><a href="#人肉还原IL-code" class="headerlink" title="人肉还原IL code"></a>人肉还原IL code</h3><p>先贴一张Opcode 对应表:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div></pre></td><td class="code"><pre><div class="line">符号						代码						原来   					修改</div><div class="line">CEE_RET					ret 					<span class="number">0</span>x2A					<span class="number">0</span>x39</div><div class="line">CEE_BRFALSE_S			brfalse<span class="selector-class">.s</span> 				<span class="number">0</span>x2C					<span class="number">0</span>x3B</div><div class="line">CEE_BRTRUE_S			brtrue<span class="selector-class">.s</span> 				<span class="number">0</span>x2D					<span class="number">0</span>x3C</div><div class="line">CEE_BRFALSE 			brfalse 				<span class="number">0</span>x39 					<span class="number">0</span>x48						</div><div class="line">CEE_BRTRUE 				brtrue 					<span class="number">0</span>x3A					<span class="number">0</span>x49</div><div class="line">CEE_BEQ																	<span class="number">0</span>x3D</div><div class="line">CEE_BGE 																<span class="number">0</span>x3E</div><div class="line">CEE_BGT 																<span class="number">0</span>x3F</div><div class="line">CEE_BLE 																<span class="number">0</span>x40</div><div class="line">CEE_BLT 																<span class="number">0</span>x41</div><div class="line">CEE_BNE_UN 																<span class="number">0</span>x42</div><div class="line">CEE_BGE_UN 																<span class="number">0</span>x43</div><div class="line">CEE_BGT_UN 																<span class="number">0</span>x44</div><div class="line">CEE_BLE_UN 																<span class="number">0</span>x45</div><div class="line">CEE_BLT_UN 																<span class="number">0</span>x46</div><div class="line"></div><div class="line">下面的有点乱，凑合着看</div><div class="line">*************</div><div class="line"></div><div class="line"><span class="number">0</span>x4A</div><div class="line"><span class="number">0</span>x4B</div><div class="line"><span class="number">0</span>x4C</div><div class="line"><span class="number">0</span>x4D</div><div class="line"><span class="number">0</span>x4E</div><div class="line"><span class="number">0</span>x4F</div><div class="line"><span class="number">0</span>x50</div><div class="line"><span class="number">0</span>x51</div><div class="line"><span class="number">0</span>x52</div><div class="line"><span class="number">0</span>x53</div><div class="line"></div><div class="line">CEE_LDIND_I1</div><div class="line">CEE_LDIND_U1</div><div class="line">CEE_LDIND_I2</div><div class="line">CEE_LDIND_U2</div><div class="line">CEE_LDIND_I4</div><div class="line">CEE_LDIND_U4</div><div class="line">CEE_LDIND_I8</div><div class="line">CEE_LDIND_I</div><div class="line">CEE_LDIND_R4</div><div class="line">CEE_LDIND_R8</div><div class="line">CEE_LDIND_REF</div><div class="line">*************</div><div class="line"></div><div class="line"><span class="number">0</span>x60</div><div class="line"><span class="number">0</span>x61</div><div class="line"><span class="number">0</span>x62</div><div class="line"><span class="number">0</span>x63</div><div class="line"><span class="number">0</span>x64</div><div class="line"><span class="number">0</span>x65</div><div class="line"><span class="number">0</span>x66</div><div class="line"><span class="number">0</span>xDF</div><div class="line"></div><div class="line"></div><div class="line">CEE_STIND_REF</div><div class="line">CEE_STIND_I1</div><div class="line">CEE_STIND_I2</div><div class="line">CEE_STIND_I4</div><div class="line">CEE_STIND_I8</div><div class="line">CEE_STIND_R4</div><div class="line">CEE_STIND_R8</div><div class="line">CEE_STIND_I</div><div class="line">***************</div><div class="line">CEE_ADD</div><div class="line">CEE_SUB</div><div class="line">CEE_DIV</div><div class="line">CEE_DIV_UN</div><div class="line">CEE_REM</div><div class="line">CEE_REM_UN</div><div class="line">CEE_AND</div><div class="line">CEE_OR</div><div class="line">CEE_XOR</div><div class="line">CEE_SHL</div><div class="line">CEE_SHR</div><div class="line">CEE_SHR_UN</div><div class="line"><span class="number">0</span>x67</div><div class="line"><span class="number">0</span>x68</div><div class="line"><span class="number">0</span>x6A</div><div class="line"><span class="number">0</span>x6B</div><div class="line"><span class="number">0</span>x6C</div><div class="line"><span class="number">0</span>x6D</div><div class="line"><span class="number">0</span>x6E</div><div class="line"><span class="number">0</span>x6F</div><div class="line"><span class="number">0</span>x70</div><div class="line"><span class="number">0</span>x71</div><div class="line"><span class="number">0</span>x72</div><div class="line"><span class="number">0</span>x73</div><div class="line">***********************</div><div class="line"></div><div class="line">CEE_LDOBJ <span class="number">0</span>x80</div><div class="line">CEE_LDSTR <span class="number">0</span>x81</div><div class="line">CEE_NEWOBJ <span class="number">0</span>x82</div><div class="line">CEE_REFANYVAL <span class="number">0</span>xC2</div><div class="line">CEE_LDTOKEN <span class="number">0</span>xD0</div><div class="line"></div><div class="line"><span class="number">0</span>x91</div><div class="line"><span class="number">0</span>x92</div><div class="line"><span class="number">0</span>x93</div><div class="line"><span class="number">0</span>x94</div><div class="line"><span class="number">0</span>x95</div><div class="line"><span class="number">0</span>x96</div><div class="line"><span class="number">0</span>x97</div><div class="line"><span class="number">0</span>x98</div><div class="line"><span class="number">0</span>x99</div><div class="line"><span class="number">0</span>x9A</div><div class="line"><span class="number">0</span>xD1</div><div class="line"><span class="number">0</span>xD2</div><div class="line"><span class="number">0</span>xD3</div><div class="line"><span class="number">0</span>xE0</div><div class="line"></div><div class="line"></div><div class="line">CEE_CONV_OVF_I1_UN</div><div class="line">CEE_CONV_OVF_I2_UN</div><div class="line">CEE_CONV_OVF_I4_UN</div><div class="line">CEE_CONV_OVF_I8_UN</div><div class="line">CEE_CONV_OVF_U1_UN</div><div class="line">CEE_CONV_OVF_U2_UN</div><div class="line">CEE_CONV_OVF_U4_UN</div><div class="line">CEE_CONV_OVF_U8_UN</div><div class="line">CEE_CONV_OVF_I_UN</div><div class="line">CEE_CONV_OVF_U_UN</div><div class="line">CEE_CONV_U2</div><div class="line">CEE_CONV_U1</div><div class="line">CEE_CONV_I</div><div class="line">CEE_CONV_U</div><div class="line"></div><div class="line">****************</div><div class="line"></div><div class="line"></div><div class="line">CEE_STELEM_I</div><div class="line">CEE_STELEM_I1</div><div class="line">CEE_STELEM_I2</div><div class="line">CEE_STELEM_I4</div><div class="line">CEE_STELEM_I8</div><div class="line">CEE_STELEM_R4</div><div class="line">CEE_STELEM_R8</div><div class="line">CEE_STELEM_REF</div><div class="line">CEE_STELEM</div><div class="line"></div><div class="line"><span class="number">0</span>xAA</div><div class="line"><span class="number">0</span>xAB</div><div class="line"><span class="number">0</span>xAC</div><div class="line"><span class="number">0</span>xAD</div><div class="line"><span class="number">0</span>xAE</div><div class="line"><span class="number">0</span>xAF</div><div class="line"><span class="number">0</span>xB0</div><div class="line"><span class="number">0</span>xB1</div><div class="line"><span class="number">0</span>xB3</div><div class="line"></div><div class="line">****************</div></pre></td></tr></table></figure>
<p>还原好之后效果（贴一个最大的函数）：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">public static byte[] Encrypt(byte[] input)</div><div class="line">&#123;</div><div class="line">	uint[] array = new uint[]</div><div class="line">	&#123;</div><div class="line">		<span class="number">1423373290</span>u,</div><div class="line">		<span class="number">363609949</span>u,</div><div class="line">		<span class="number">512121596</span>u,</div><div class="line">		<span class="number">1703126449</span>u</div><div class="line">	&#125;;</div><div class="line">	byte[] array2 = new byte[0];</div><div class="line">	int num = input.Length;</div><div class="line">	byte[] array3 = new byte[8];</div><div class="line">	int num2 = 7 - num % 8;</div><div class="line">	array3[0] = (byte)num2;</div><div class="line">	for (int i = 0; i &lt; num2; i++)</div><div class="line">	&#123;</div><div class="line">		array3[i + 1] = (byte)(200 + num2 - i);</div><div class="line">	&#125;</div><div class="line">	for (int j = 0; j &lt; 7 - num2; j++)</div><div class="line">	&#123;</div><div class="line">		array3[j + num2 + 1] = input[j];</div><div class="line">	&#125;</div><div class="line">	uint[] array4 = new uint[]</div><div class="line">	&#123;</div><div class="line">		MyClass.ConvertBytesToUInt(array3, <span class="number">0</span>),</div><div class="line">		MyClass.ConvertBytesToUInt(array3, <span class="number">4</span>)</div><div class="line">	&#125;;</div><div class="line">	array4[0] = (array4[0] ^ array[0]);</div><div class="line">	array4[1] = (array4[1] ^ array[2]);</div><div class="line">	array4 = MyClass.Code(array4, array);</div><div class="line">	array2 = MyClass.CombineBytes(array2, MyClass.ConvertUIntToBytes(array4[0]));</div><div class="line">	array2 = MyClass.CombineBytes(array2, MyClass.ConvertUIntToBytes(array4[1]));</div><div class="line">	for (int k = 7 - num2; k &lt; num; k += 8)</div><div class="line">	&#123;</div><div class="line">		array4[0] ^= MyClass.ConvertBytesToUInt(input, k);</div><div class="line">		array4[1] ^= MyClass.ConvertBytesToUInt(input, k + 4);</div><div class="line">		array4 = MyClass.Code(array4, array);</div><div class="line">		array2 = MyClass.CombineBytes(array2, MyClass.ConvertUIntToBytes(array4[0]));</div><div class="line">		array2 = MyClass.CombineBytes(array2, MyClass.ConvertUIntToBytes(array4[1]));</div><div class="line">	&#125;</div><div class="line">	return array2;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>算法是XTEA的变种，链接这里：<br><a href="https://en.wikipedia.org/wiki/XTEA" target="_blank" rel="external">https://en.wikipedia.org/wiki/XTEA</a></p>
<p>说实话，我这方法有点麻烦，你们出题有点猥琐。</p>
<h3 id="0x2-解密函数解密data"><a href="#0x2-解密函数解密data" class="headerlink" title="0x2 解密函数解密data"></a>0x2 解密函数解密data</h3><p>直接上代码，wp写累了：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div></pre></td><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line">using System.IO;</div><div class="line"></div><div class="line"></div><div class="line">namespace TENCENT2017</div><div class="line">&#123;</div><div class="line">    class Program</div><div class="line">    &#123;</div><div class="line">        static void Main(string[] args)</div><div class="line">        &#123;</div><div class="line">            EncryptDataFile();</div><div class="line">            DecryptDataFile();</div><div class="line">            Console.WriteLine("Hello GSLab!");</div><div class="line">        &#125;</div><div class="line">        public static void EncryptDataFile()</div><div class="line">        &#123;</div><div class="line">            byte[] array;</div><div class="line">            using (FileStream fileStream = new FileStream(<span class="string">"areyouok.png"</span>, FileMode.Open))</div><div class="line">            &#123;</div><div class="line">                using (BinaryReader binaryReader = new BinaryReader(fileStream))</div><div class="line">                &#123;</div><div class="line">                    array = binaryReader.ReadBytes(Convert.ToInt32(fileStream.Length));</div><div class="line">                    array = Encrypt(array);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            using (FileStream fileStream2 = new FileStream(<span class="string">"areyouok_encrypted"</span>, FileMode.Create))</div><div class="line">            &#123;</div><div class="line">                using (BinaryWriter binaryWriter = new BinaryWriter(fileStream2))</div><div class="line">                &#123;</div><div class="line">                    binaryWriter.Write(array);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        public static void DecryptDataFile()</div><div class="line">        &#123;</div><div class="line">            byte[] array;</div><div class="line">            using (FileStream fileStream = new FileStream(<span class="string">"data.encrypted"</span>, FileMode.Open))</div><div class="line">            &#123;</div><div class="line">                using (BinaryReader binaryReader = new BinaryReader(fileStream))</div><div class="line">                &#123;</div><div class="line">                    array = binaryReader.ReadBytes(Convert.ToInt32(fileStream.Length));</div><div class="line">                    array = Decrypt(array);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            using (FileStream fileStream2 = new FileStream(<span class="string">"de-data.encrypted.png"</span>, FileMode.Create))</div><div class="line">            &#123;</div><div class="line">                using (BinaryWriter binaryWriter = new BinaryWriter(fileStream2))</div><div class="line">                &#123;</div><div class="line">                    binaryWriter.Write(array);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        public static byte[] Decrypt(byte[] input)</div><div class="line">        &#123;</div><div class="line">            int num = input.Length;</div><div class="line">            uint[] array = new uint[]</div><div class="line">	        &#123;</div><div class="line">		        <span class="number">1423373290</span>u,</div><div class="line">		        <span class="number">363609949</span>u,</div><div class="line">		        <span class="number">512121596</span>u,</div><div class="line">		        <span class="number">1703126449</span>u</div><div class="line">	        &#125;;</div><div class="line">            byte[] array2 = new byte[0];</div><div class="line">            uint[] array4 = new uint[]</div><div class="line">	        &#123;</div><div class="line">		        <span class="number">0</span>,</div><div class="line">		        <span class="number">0</span></div><div class="line">	        &#125;;</div><div class="line">            uint[] array5 = new uint[]</div><div class="line">	        &#123;</div><div class="line">		        <span class="number">0</span>,</div><div class="line">		        <span class="number">0</span></div><div class="line">	        &#125;;</div><div class="line"></div><div class="line">            for (int k = num-4; k &gt;=12; k -= 8)</div><div class="line">            &#123;</div><div class="line">               array4[1] = ConvertBytesToUInt(input, k );</div><div class="line">               array4[0] = ConvertBytesToUInt(input, k-4);</div><div class="line">               array4 = DeCode(array4, array);</div><div class="line">               array4[1] ^= ConvertBytesToUInt(input, k -8);</div><div class="line">               array4[0] ^= ConvertBytesToUInt(input, k - 12);</div><div class="line">               array2 = CombineBytes2(array2, ConvertUIntToBytes(array4[1]));</div><div class="line">               array2 = CombineBytes2(array2, ConvertUIntToBytes(array4[0]));</div><div class="line">               </div><div class="line">            &#125;</div><div class="line">            return array2;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        private static uint[] DeCode(uint[] v, uint[] k)</div><div class="line">        &#123;</div><div class="line">            uint num = v[0];</div><div class="line">            uint num2 = v[1];</div><div class="line">            uint num3 = 0u;</div><div class="line">            uint num4 = Convert.ToUInt32(Math.Floor((Math.Pow(5.0, 0.5) - 1.0) * Math.Pow(2.0, 31.0)));</div><div class="line">            uint num5 = 32u;</div><div class="line">            while (num5-- &gt; <span class="number">0</span>u)</div><div class="line">            &#123;</div><div class="line">                num3 += num4;</div><div class="line">            &#125;</div><div class="line">            num5 = 32u;</div><div class="line">            while (num5-- &gt; <span class="number">0</span>u)</div><div class="line">            &#123;</div><div class="line">                num2-= (num &lt;&lt; 4 ^ (num &gt;&gt; 5) + num ^ num3 + k[(int)((ushort)(num3 &gt;&gt; 11 &amp; 3u))]);</div><div class="line">                num3 -= num4;</div><div class="line">                num -= (num2 &lt;&lt; 4 ^ (num2 &gt;&gt; 5) + num2 ^ num3 + k[(int)((ushort)(num3 &amp; 3u))]);</div><div class="line">               Console.WriteLine(" &#123;0&#125; &#123;1&#125; &#123;2&#125;.", num, num2, num3);</div><div class="line">                </div><div class="line">            &#125;</div><div class="line">            return new uint[]</div><div class="line">	&#123;</div><div class="line">		num,</div><div class="line">		num2</div><div class="line">	&#125;;</div><div class="line">        &#125;</div><div class="line">        public static byte[] Encrypt(byte[] input)</div><div class="line">        &#123;</div><div class="line">            uint[] array = new uint[]</div><div class="line">	&#123;</div><div class="line">		<span class="number">1423373290</span>u,</div><div class="line">		<span class="number">363609949</span>u,</div><div class="line">		<span class="number">512121596</span>u,</div><div class="line">		<span class="number">1703126449</span>u</div><div class="line">	&#125;;</div><div class="line">            byte[] array2 = new byte[0];</div><div class="line">            int num = input.Length;</div><div class="line">            byte[] array3 = new byte[8];</div><div class="line">            int num2 = 7 - num % 8;</div><div class="line">            array3[0] = (byte)num2;</div><div class="line">            for (int i = 0; i &lt; num2; i++)</div><div class="line">            &#123;</div><div class="line">                array3[i + 1] = (byte)(200 + num2 - i);</div><div class="line">            &#125;</div><div class="line">            for (int j = 0; j &lt; 7 - num2; j++)</div><div class="line">            &#123;</div><div class="line">                array3[j + num2 + 1] = input[j];</div><div class="line">            &#125;</div><div class="line">            uint[] array4 = new uint[]</div><div class="line">	&#123;</div><div class="line">		ConvertBytesToUInt(array3, <span class="number">0</span>),</div><div class="line">		ConvertBytesToUInt(array3, <span class="number">4</span>)</div><div class="line">	&#125;;</div><div class="line">            array4[0] = (array4[0] ^ array[0]);</div><div class="line">            array4[1] = (array4[1] ^ array[2]);</div><div class="line">            array4 = Code(array4, array);</div><div class="line">            array2 = CombineBytes(array2, ConvertUIntToBytes(array4[0]));</div><div class="line">            array2 = CombineBytes(array2, ConvertUIntToBytes(array4[1]));</div><div class="line">            for (int k = 7 - num2; k &lt; num; k += 8)</div><div class="line">            &#123;</div><div class="line">                array4[0] ^= ConvertBytesToUInt(input, k);</div><div class="line">                array4[1] ^= ConvertBytesToUInt(input, k + 4);</div><div class="line">                array4 = Code(array4, array);</div><div class="line">                array2 = CombineBytes(array2, ConvertUIntToBytes(array4[0]));</div><div class="line">                array2 = CombineBytes(array2, ConvertUIntToBytes(array4[1]));</div><div class="line">            &#125;</div><div class="line">            return array2;</div><div class="line">        &#125;</div><div class="line">        private static byte[] ConvertUIntToBytes(uint input)</div><div class="line">        &#123;</div><div class="line">            return new byte[]</div><div class="line">	            &#123;</div><div class="line">		            (byte)(<span class="selector-tag">input</span> &amp; <span class="number">255</span>u),</div><div class="line">		            (byte)(<span class="selector-tag">input</span> &gt;&gt; <span class="number">8</span> &amp; <span class="number">255</span>u),</div><div class="line">		            (byte)(<span class="selector-tag">input</span> &gt;&gt; <span class="number">16</span> &amp; <span class="number">255</span>u),</div><div class="line">		            (byte)(<span class="selector-tag">input</span> &gt;&gt; <span class="number">24</span> &amp; <span class="number">255</span>u)</div><div class="line">	            &#125;;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        private static uint ConvertBytesToUInt(byte[] <span class="selector-tag">input</span>, int pos)</div><div class="line">        &#123;</div><div class="line">            uint num = (uint)input[pos];</div><div class="line">            num += (uint)((uint)input[pos + 1] &lt;&lt; 8);</div><div class="line">            num += (uint)((uint)input[pos + 2] &lt;&lt; 16);</div><div class="line">            return num + (uint)((uint)input[pos + 3] &lt;&lt; 24);</div><div class="line">        &#125;</div><div class="line">        private static byte[] CombineBytes(byte[] bytes1, byte[] bytes2)</div><div class="line">        &#123;</div><div class="line">            byte[] array = new byte[bytes1.Length + bytes2.Length];</div><div class="line">            Buffer.BlockCopy(bytes1, 0, array, 0, bytes1.Length);</div><div class="line">            Buffer.BlockCopy(bytes2, 0, array, bytes1.Length, bytes2.Length);</div><div class="line">            return array;</div><div class="line">        &#125;</div><div class="line">        private static byte[] CombineBytes2(byte[] bytes1, byte[] bytes2)</div><div class="line">        &#123;</div><div class="line">            byte[] array = new byte[bytes1.Length + bytes2.Length];</div><div class="line">            Buffer.BlockCopy(bytes2, 0, array, 0, bytes2.Length);</div><div class="line">            Buffer.BlockCopy(bytes1, 0, array, bytes2.Length, bytes1.Length);</div><div class="line">            return array;</div><div class="line">        &#125;</div><div class="line">        private static uint[] Code(uint[] v, uint[] k)</div><div class="line">        &#123;</div><div class="line">            uint num = v[0];</div><div class="line">            uint num2 = v[1];</div><div class="line">            uint num3 = 0u;</div><div class="line">            uint num4 = Convert.ToUInt32(Math.Floor((Math.Pow(5.0, 0.5) - 1.0) * Math.Pow(2.0, 31.0)));</div><div class="line">            uint num5 = 32u;</div><div class="line">            while (num5-- &gt; <span class="number">0</span>u)</div><div class="line">            &#123;</div><div class="line">                num += (num2 &lt;&lt; 4 ^ (num2 &gt;&gt; 5) + num2 ^ num3 + k[(int)((ushort)(num3 &amp; 3u))]);</div><div class="line">                num3 += num4;</div><div class="line">                num2 += (num &lt;&lt; 4 ^ (num &gt;&gt; 5) + num ^ num3 + k[(int)((ushort)(num3 &gt;&gt; 11 &amp; 3u))]);</div><div class="line">               <span class="comment">// Console.WriteLine(" &#123;0&#125; &#123;1&#125; &#123;2&#125;.", num, num2, num3);</span></div><div class="line">            &#125;</div><div class="line">            return new uint[]</div><div class="line">	&#123;</div><div class="line">		num,</div><div class="line">		num2</div><div class="line">	&#125;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="0x3-最后的战役"><a href="#0x3-最后的战役" class="headerlink" title="0x3 最后的战役"></a>0x3 最后的战役</h3><p>这一问好开放，只能靠脑洞了。解密出来的是一个藏着数据的png。修复头之后提示格式问题，去熟悉格式。<br>又不会，直接链接如下，一起学习之：<br><a href="https://wenku.baidu.com/view/a991270f76c66137ee061967.html" target="_blank" rel="external">https://wenku.baidu.com/view/a991270f76c66137ee061967.html</a><br><a href="https://www.ietf.org/rfc/rfc1951.txt" target="_blank" rel="external">https://www.ietf.org/rfc/rfc1951.txt</a><br><a href="http://www.sweetscape.com/010editor/repository/files/PNG.bt" target="_blank" rel="external">http://www.sweetscape.com/010editor/repository/files/PNG.bt</a></p>
<p>发现第4个CHUNK 有问题，感觉这个就是目标数据。然后去修了很久，卡了很久这里。找了几个png的图片对照，发现这里多了很多FF，完全没有的东西，一开始还以为，然后各种找压缩算法，zlib，lz77的各种衍生算法，都没能压缩对。<br>后来找一些关于图片的分析，查到一个图像隐写，然后继续查资料，学习，一直纠结于这个东西，当然没有结果。<br>最后发现是位图格式，bmp，我倒。然后就OK了。<br>其实题目有提示，我想当然的理解错了。</p>
<p>整个比赛就结束了，谢谢观看，不足之处请看官斧正！</p>
<p>2017.7.23</p>
<p>By Ericky</p>

    
  </div>
  <footer>
    
      
  <div class="categories">
    <a class="categories-link" href="/categories/Android/">Android</a>
  </div>

      
    
    <div class="clearfix"></div>
  </footer>
</article>

</div>
  </div>
  <footer id="footer"><div class="copyright">
  
  &copy; 2017 <a href="/">The darkness is no darkness with thee.</a>
  
</div>
<div class="theme-copyright">

</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="/js/scale.fix.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    $('.fancybox').fancybox();
  })(jQuery);
</script>

</body>
</html>