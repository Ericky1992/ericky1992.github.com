<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  
  <title>Ericky1992</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
    <meta name="author" content="The darkness is no darkness with thee.">
  
  
  <meta name="description" content="忘記妳是最痛苦的解藥">
<meta property="og:type" content="website">
<meta property="og:title" content="Ericky1992">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Ericky1992">
<meta property="og:description" content="忘記妳是最痛苦的解藥">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ericky1992">
<meta name="twitter:description" content="忘記妳是最痛苦的解藥">
  
  
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <div class="wrapper">
    <header id="header">
  <div class="title">
    <h1><a href="/">Ericky1992</a></h1>
    <p><a href="/">pursue ceaselessly</a></p>
  </div>
  <nav class="nav">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/">About</a></li>
      
      
    </ul>
    <div class="clearfix"></div>
  </nav>
  <div class="clearfix"></div>
</header>
    <div class="content">




  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/11/02/Dex加固总结之腾讯加固/">
  <time datetime="2015-11-02T08:01:00.000Z">
    2015-11-02
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/11/02/Dex加固总结之腾讯加固/">Dex加固总结之腾讯加固</a></h1>
  

  </header>
  
  <div class="entry">
    
      <h2 id="Dex加固总结之腾讯加固"><a href="#Dex加固总结之腾讯加固" class="headerlink" title="Dex加固总结之腾讯加固"></a>Dex加固总结之腾讯加固</h2><p>【作者声明】：只是感兴趣，没有其他目的。失误之处敬请诸位大侠赐教！</p>
<p>由于dex脱壳的文章很多，讲原理的文章也到处都是，所以我就不抛砖头误导大家了。快到2016年了，时隔一年，来总结一下这些加固厂商的手法。</p>
<h3 id="1-加固前后文件对比，左边为原包"><a href="#1-加固前后文件对比，左边为原包" class="headerlink" title="1.加固前后文件对比，左边为原包"></a>1.加固前后文件对比，左边为原包</h3><p><img src="http://img.blog.csdn.net/20151102155103307" alt="这里写图片描述"></p>
<h3 id="2-脱壳后类名结构"><a href="#2-脱壳后类名结构" class="headerlink" title="2.脱壳后类名结构"></a>2.脱壳后类名结构</h3><p><img src="http://img.blog.csdn.net/20151102155125074" alt="这里写图片描述"><br>tencent.StubShell主要是用来执行腾讯的逻辑代码。</p>
<h3 id="3-使得反编译工具失败"><a href="#3-使得反编译工具失败" class="headerlink" title="3.使得反编译工具失败"></a>3.使得反编译工具失败</h3><p>插入一个A001类，导致反编译Smali失败<br><img src="http://img.blog.csdn.net/20151102155132941" alt="这里写图片描述"><br>                                    图一<br><img src="http://img.blog.csdn.net/20151102155143614" alt="这里写图片描述"><br>                                    图二<br>能看到这些的话，腾讯App加固脱壳就完成了。</p>
<p>Game Over<br>―――――――――――――――――――――――――――――――――<br>2015.11.02<br>By Ericky      </p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/08/10/早期学习写壳代码/">
  <time datetime="2015-08-10T05:49:00.000Z">
    2015-08-10
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/08/10/早期学习写壳代码/">早期学习写壳代码</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>早期自己弄的一些东西，大牛绕过。<br>入门写壳的同学可以参考看看。<br>效果如下：<br><img src="http://img.blog.csdn.net/20150810134504878" alt="这里写图片描述"><br>Java 层：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">package com.droider.crackme0201;</div><div class="line"></div><div class="line"></div><div class="line">import java.lang.String;</div><div class="line">import android.app.Application;</div><div class="line">import android.content.Context;</div><div class="line">import android.content.res.Configuration;</div><div class="line"></div><div class="line">public class TestApplication extends Application &#123;</div><div class="line">	static&#123;</div><div class="line">		System.loadLibrary(&quot;Nothing&quot;);</div><div class="line"></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	@Override</div><div class="line">	protected void attachBaseContext(Context base) &#123;</div><div class="line">		super.attachBaseContext(base);</div><div class="line">		ErickyGuard(base);</div><div class="line">		ErickyProtect(base);</div><div class="line">		</div><div class="line">	&#125;</div><div class="line"></div><div class="line"></div><div class="line">	public native void ErickyGuard(Context context);</div><div class="line">	public native Object ErickyProtect(Context context);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>C层：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div></pre></td><td class="code"><pre><div class="line">#include &lt;string.h&gt;</div><div class="line">#include &lt;stdlib.h&gt;</div><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &lt;jni.h&gt;</div><div class="line">#include &lt;android/log.h&gt;</div><div class="line">#include &lt;sys/stat.h&gt;</div><div class="line">#include &lt;unistd.h&gt;</div><div class="line">#include &lt;sys/types.h&gt;</div><div class="line">#include &lt;elf.h&gt;</div><div class="line">#include &lt;sys/mman.h&gt;</div><div class="line">#include &lt;assert.h&gt;</div><div class="line">#define DEBUG</div><div class="line">#define   LOG_TAG    &quot;LOG_TEST&quot;</div><div class="line">#define   LOGI(...)  __android_log_print(ANDROID_LOG_INFO,LOG_TAG,__VA_ARGS__)</div><div class="line">#define   LOGE(...)  __android_log_print(ANDROID_LOG_ERROR,LOG_TAG,__VA_ARGS__)</div><div class="line">// 获取数组的大小</div><div class="line"># define NELEM(x) ((int) (sizeof(x) / sizeof((x)[0])))</div><div class="line">// 指定要注册的类，对应完整的java类名</div><div class="line">#define JNIREG_CLASS &quot;com/droider/crackme0201/TestApplication&quot;</div><div class="line">//Function  Statements</div><div class="line"></div><div class="line">jstring   CharTojstring(JNIEnv*   env,   char*   str);</div><div class="line">jobject invokeStaticMethodss (JNIEnv *env,jstring class_name, jstring method_name, jobjectArray pareTyple, jobjectArray pareVaules);</div><div class="line">jobject   getFieldOjbect(JNIEnv *env,		jstring class_name, jobject obj, jstring fieldName);</div><div class="line">void     setFieldOjbect(JNIEnv *env, jstring class_name, jstring fieldName, jobject obj, jobject filedVaule);</div><div class="line">void 		guard( JNIEnv* env,jobject thiz,jobject context );</div><div class="line">JNIEXPORT jobject JNICALL sub_2222( JNIEnv* env,</div><div class="line">                                                  jobject thiz,jobject context )</div><div class="line"></div><div class="line">&#123;</div><div class="line"></div><div class="line">	jclass native_clazz = env-&gt;GetObjectClass(context);</div><div class="line">	jmethodID methodID_func = env-&gt;GetMethodID(native_clazz,&quot;getPackageName&quot;, &quot;()Ljava/lang/String;&quot;);</div><div class="line">	jstring packagename =(jstring)(env-&gt;CallObjectMethod(context, methodID_func));</div><div class="line">	//**************************************</div><div class="line">	char *aa=&quot;android.app.ActivityThread&quot;, *bb = &quot;currentActivityThread&quot;;</div><div class="line">	jstring jaa= CharTojstring(env,aa);</div><div class="line">	jstring jbb = CharTojstring(env,bb);</div><div class="line">	jobjectArray pareTyple;</div><div class="line">	jobjectArray pareVaules;</div><div class="line">	jobject currentActivityThread = invokeStaticMethodss(env,jaa,jbb,pareTyple,pareVaules );</div><div class="line">	char *cc=&quot;android.app.ActivityThread&quot;, *dd = &quot;mPackages&quot;;</div><div class="line">	jstring jcc= CharTojstring(env,cc);</div><div class="line">	jstring jdd = CharTojstring(env,dd);</div><div class="line">	        jclass class_hashmap=env-&gt;FindClass(&quot;java/util/HashMap&quot;);</div><div class="line">	        jmethodID hashmap_construct_method=env-&gt;GetMethodID(class_hashmap, &quot;&lt;init&gt;&quot;,&quot;()V&quot;);</div><div class="line">	        jobject obj_hashmap =env-&gt;NewObject(class_hashmap, hashmap_construct_method, &quot;&quot;);</div><div class="line">	        obj_hashmap = getFieldOjbect(env,jcc, currentActivityThread,jdd);</div><div class="line">	   // newä¸€ä¸ªWeakReferenceå¯¹è±¡java.lang.ref.WeakReference   get_get_obj ==wr.get();</div><div class="line">	        jclass class_WeakReference=env-&gt;FindClass(&quot;java/lang/ref/WeakReference&quot;);</div><div class="line">	        if(class_WeakReference==NULL)&#123;</div><div class="line">	        	LOGI(&quot;class_WeakReference Not Found &quot;);</div><div class="line"></div><div class="line">	        &#125;</div><div class="line">	        jmethodID WeakReference_get_method=env-&gt;GetMethodID(class_WeakReference, &quot;get&quot;,&quot;()Ljava/lang/Object;&quot;);</div><div class="line">	        if(WeakReference_get_method==NULL)&#123;</div><div class="line">	        	        	LOGI(&quot;WeakReference_get_method Not Found &quot;);</div><div class="line"></div><div class="line">	        	        &#125;</div><div class="line">	        jmethodID get_func = env-&gt;GetMethodID(class_hashmap,&quot;get&quot;,&quot;(Ljava/lang/Object;)Ljava/lang/Object;&quot;);</div><div class="line">	        if(get_func==NULL)&#123;</div><div class="line">	       	        	        	LOGI(&quot;get_func Not Found &quot;);</div><div class="line">	       	&#125;</div><div class="line">	        jobject get_obj =env-&gt;CallObjectMethod(obj_hashmap, get_func,packagename);</div><div class="line">	        if(get_obj==NULL)&#123;</div><div class="line">	        	       	        	        	LOGI(&quot;get_obj Not Found &quot;);</div><div class="line">	        &#125;</div><div class="line">	        jobject get_get_obj = env-&gt;CallObjectMethod(get_obj, WeakReference_get_method);</div><div class="line">	        if(get_get_obj==NULL)&#123;</div><div class="line">	        	        	       	        	        	LOGI(&quot;get_get_obj Not Found &quot;);</div><div class="line">	         &#125;</div><div class="line">	        //Strings prepared</div><div class="line">	        const char *str = env-&gt;GetStringUTFChars(packagename, 0);</div><div class="line">	        char parameter1[128];</div><div class="line">	        char parameter2[128];</div><div class="line">	        char parameter3[128];</div><div class="line">	        const char *qz =&quot;/data/data/&quot;, *hz1 = &quot;/.cache/classdex.jar&quot; ,*hz2 = &quot;/.cache&quot;,*hz3 = &quot;/.cache/&quot;;</div><div class="line">	        strcpy(parameter1, qz);</div><div class="line">	        strcat(parameter1, str);</div><div class="line">	        strcat(parameter1, hz1);</div><div class="line">	        strcpy(parameter2, qz);</div><div class="line">	        strcat(parameter2, str);</div><div class="line">	       	strcat(parameter2, hz2);</div><div class="line">	       	strcpy(parameter3, qz);</div><div class="line">	       	strcat(parameter3, str);</div><div class="line">	       	strcat(parameter3, hz3);</div><div class="line">	       	env-&gt;ReleaseStringUTFChars(packagename, str);</div><div class="line">	       	jstring jparameter1 = CharTojstring(env,parameter1);</div><div class="line">	       	jstring jparameter2 = CharTojstring(env,parameter2);</div><div class="line">	       	jstring jparameter3 = CharTojstring(env,parameter3);</div><div class="line">	       	char *loadapk = &quot;android.app.LoadedApk&quot;,*mClassLoader = &quot;mClassLoader&quot;;</div><div class="line">	       	jstring jloadapk= CharTojstring(env,loadapk);</div><div class="line">	       	jstring jmClassLoader = CharTojstring(env,mClassLoader);</div><div class="line">	        jclass class_DexClassloader=env-&gt;FindClass(&quot;dalvik/system/DexClassLoader&quot;);</div><div class="line">	        if(class_DexClassloader==NULL)&#123;</div><div class="line">	        			LOGI(&quot;class_DexClassloader Not Found &quot;);</div><div class="line">	       	         &#125;</div><div class="line">	        jmethodID DexClassloader_construct_method=env-&gt;GetMethodID(class_DexClassloader, &quot;&lt;init&gt;&quot;,&quot;(Ljava/lang/String;Ljava/lang/String;Ljava/lang/String;Ljava/lang/ClassLoader;)V&quot;);</div><div class="line">	        if(DexClassloader_construct_method==NULL)&#123;</div><div class="line">	       	        	        	       	        	        	LOGI(&quot;DexClassloader_construct_method Not Found &quot;);</div><div class="line">	       	         &#125;</div><div class="line">	        jobject obj_DexClassloader =env-&gt;NewObject(class_DexClassloader, DexClassloader_construct_method,jparameter1,jparameter2,jparameter3,getFieldOjbect(env,jloadapk,get_get_obj,jmClassLoader));</div><div class="line">	        if(obj_DexClassloader==NULL)&#123;</div><div class="line">	       	        	        	       	        	        	LOGI(&quot;obj_DexClassloader Not Found &quot;);</div><div class="line">	       	 &#125;</div><div class="line">	        setFieldOjbect(env,jloadapk,jmClassLoader,get_get_obj, obj_DexClassloader);</div><div class="line"></div><div class="line">	        return get_get_obj;</div><div class="line">&#125;</div><div class="line">JNIEXPORT void JNICALL sub_1111( JNIEnv* env,</div><div class="line">                                                  jobject thiz,jobject context )</div><div class="line">&#123;</div><div class="line">	guard(env,thiz,context );</div><div class="line">&#125;</div><div class="line"></div><div class="line">// Java和JNI函数的绑定表</div><div class="line">static JNINativeMethod method_table[] = &#123;</div><div class="line">	&#123; &quot;ErickyProtect&quot;, &quot;(Landroid/content/Context;)Ljava/lang/Object;&quot;, (void*)sub_2222 &#125;,//绑定Ericky3</div><div class="line">	&#123; &quot;ErickyGuard&quot;, &quot;(Landroid/content/Context;)V&quot;, (void*)sub_1111 &#125;,//Ericky1</div><div class="line">&#125;;</div><div class="line">// 注册native方法到java中</div><div class="line">static int registerNativeMethods(JNIEnv* env, const char* className,</div><div class="line">        JNINativeMethod* gMethods, int numMethods)</div><div class="line">&#123;</div><div class="line">	jclass clazz;</div><div class="line">	clazz = env-&gt;FindClass( className);</div><div class="line">	if (clazz == NULL) &#123;</div><div class="line">		return JNI_FALSE;</div><div class="line">	&#125;</div><div class="line">	if (env-&gt;RegisterNatives(clazz, gMethods, numMethods) &lt; 0) &#123;</div><div class="line">		return JNI_FALSE;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	return JNI_TRUE;</div><div class="line">&#125;</div><div class="line"></div><div class="line">int register_ndk_load(JNIEnv *env)</div><div class="line">&#123;</div><div class="line">	// 调用注册方法</div><div class="line">    return registerNativeMethods(env, JNIREG_CLASS,</div><div class="line">            method_table, NELEM(method_table));</div><div class="line">&#125;</div><div class="line"></div><div class="line">JNIEXPORT jint JNI_OnLoad(JavaVM* vm, void* reserved)</div><div class="line">&#123;</div><div class="line">    JNIEnv* env = NULL;</div><div class="line">    jint result = -1;</div><div class="line"></div><div class="line">    if (vm-&gt;GetEnv((void**) &amp;env, JNI_VERSION_1_4) != JNI_OK) &#123;</div><div class="line">        return result;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    register_ndk_load(env);</div><div class="line"></div><div class="line">	// 返回jni的版本</div><div class="line">    return JNI_VERSION_1_4;</div><div class="line">&#125;</div><div class="line">//Copy fuctions and initial fuctions</div><div class="line">void guard( JNIEnv* env,jobject thiz,jobject context )</div><div class="line">&#123;</div><div class="line">			jclass native_clazz = env-&gt;GetObjectClass(context);</div><div class="line">			jmethodID methodID_func = env-&gt;GetMethodID(native_clazz,&quot;getPackageName&quot;, &quot;()Ljava/lang/String;&quot;);</div><div class="line">			jstring packagename =(jstring)(env-&gt;CallObjectMethod(context, methodID_func));</div><div class="line">				const char *str = env-&gt;GetStringUTFChars(packagename, 0);</div><div class="line">				char destination[128];</div><div class="line">			    const char *blank =&quot;/data/data/&quot;, *c = &quot;/.cache/&quot;;</div><div class="line">				strcpy(destination, blank);</div><div class="line">				strcat(destination, str);</div><div class="line">				strcat(destination, c);</div><div class="line">				LOGI(&quot;stringcccccccccccccccc %s&quot;,destination);//åŽ»å­—ç¬¦ä¸²s%</div><div class="line"></div><div class="line">				env-&gt;ReleaseStringUTFChars(packagename, str);</div><div class="line">				jint a = mkdir(destination,777);</div><div class="line"></div><div class="line">				LOGI(&quot;Created a file in android! %d&quot;,a);//åŽ»å­—ç¬¦ä¸²s%</div><div class="line">				const char *pre = &quot;chmod 755 &quot;;</div><div class="line">				char cmd[128];</div><div class="line">				strcpy(cmd, pre);</div><div class="line">				strcat(cmd, destination);</div><div class="line">				LOGI(&quot;cmd %s&quot;,cmd);//åŽ»å­—ç¬¦ä¸²s%</div><div class="line">				jstring jcmd = CharTojstring(env,cmd);</div><div class="line"></div><div class="line">			//exec</div><div class="line">				jclass Runtime = env-&gt;FindClass(&quot;java/lang/Runtime&quot;);</div><div class="line">				jmethodID Runtime_func = env-&gt;GetStaticMethodID(Runtime,&quot;getRuntime&quot;,&quot;()Ljava/lang/Runtime;&quot;);</div><div class="line">				jobject class_obj =	env-&gt;CallStaticObjectMethod(Runtime, Runtime_func);</div><div class="line">				jclass class_java = env-&gt;GetObjectClass(class_obj);</div><div class="line"></div><div class="line">				jmethodID exec_func = env-&gt;GetMethodID(class_java,&quot;exec&quot;,&quot;(Ljava/lang/String;)Ljava/lang/Process;&quot;);</div><div class="line">				jobject method_obj =env-&gt;CallObjectMethod(class_obj, exec_func,jcmd);</div><div class="line">				jclass class_method_obj= env-&gt;GetObjectClass(method_obj);</div><div class="line"></div><div class="line">				jmethodID waitfor_func = env-&gt;GetMethodID(class_method_obj,&quot;waitFor&quot;,&quot;()I&quot;);</div><div class="line">				jint result = env-&gt;CallIntMethod(method_obj,waitfor_func);</div><div class="line"></div><div class="line">				LOGI(&quot;CallIntMethod %d&quot;,result);//åŽ»å­—ç¬¦ä¸²s%</div><div class="line">	//***************************************************************************************Copy fuctions</div><div class="line">				//************************despath</div><div class="line">					// èŽ·å¾— Context ç±»</div><div class="line">					jclass native_clazz2 = env-&gt;GetObjectClass(context);</div><div class="line">					jmethodID methodID_func2 = env-&gt;GetMethodID(native_clazz2,&quot;getPackageName&quot;, &quot;()Ljava/lang/String;&quot;);</div><div class="line">					jstring packagename2 =(jstring)(env-&gt;CallObjectMethod(context, methodID_func2));</div><div class="line">					const char *str2 = env-&gt;GetStringUTFChars(packagename2, 0);</div><div class="line">					char destination2[128];</div><div class="line">				    const char *blank2 =&quot;/data/data/&quot;, *c2 = &quot;/.cache/classdex.jar&quot;;</div><div class="line">					strcpy(destination2, blank2);</div><div class="line">					strcat(destination2, str2);</div><div class="line">					strcat(destination2, c2);</div><div class="line">					LOGI(&quot;string %s&quot;,destination2);</div><div class="line">					LOGI(&quot;log test ok &quot;);</div><div class="line">					env-&gt;ReleaseStringUTFChars(packagename2, str2);</div><div class="line">					jstring jdestination = CharTojstring(env,destination2);</div><div class="line">					jmethodID methodID_getApplicationInfo = env-&gt;GetMethodID(native_clazz2,&quot;getApplicationInfo&quot;, &quot;()Landroid/content/pm/ApplicationInfo;&quot;);</div><div class="line">					jobject ApplicationInfo =env-&gt;CallObjectMethod(context, methodID_getApplicationInfo);</div><div class="line">					jclass cls_ApplicationInfo=env-&gt;GetObjectClass(ApplicationInfo);</div><div class="line"></div><div class="line">					jfieldID JarFieldId = env-&gt;GetFieldID(cls_ApplicationInfo,&quot;publicSourceDir&quot;, &quot;Ljava/lang/String;&quot;);</div><div class="line"></div><div class="line">					jstring SourceDir =(jstring)(env-&gt;GetObjectField(ApplicationInfo,JarFieldId));</div><div class="line">						const char *strs = env-&gt;GetStringUTFChars(SourceDir, 0);</div><div class="line">						char destinations[128];</div><div class="line">						strcpy(destinations, strs);</div><div class="line">						jbyteArray bytes = env-&gt;NewByteArray(65536);</div><div class="line">						LOGI(&quot;HAHAHAHHAHAHAHA %s&quot;,destinations);//</div><div class="line">						env-&gt;ReleaseStringUTFChars(SourceDir, strs);</div><div class="line">						LOGI(&quot;HAHAHAHHAHAHAHA222222222222222â€œ&quot;);</div><div class="line">						//initial strings</div><div class="line">						char *classdex_jar2=&quot;assets/ErickyProtect.so&quot;;//包里的文件</div><div class="line">						jstring jclassdex_jar = CharTojstring(env,classdex_jar2);</div><div class="line">						////////////new JarFile</div><div class="line">						jclass cls_JarFile = env-&gt;FindClass(&quot;java/util/jar/JarFile&quot;);</div><div class="line">					    jmethodID methodID_JarFile = env-&gt;GetMethodID(cls_JarFile,&quot;&lt;init&gt;&quot;, &quot;(Ljava/lang/String;)V&quot;);</div><div class="line">					jobject localJarFile = env-&gt;NewObject(cls_JarFile, methodID_JarFile,SourceDir);</div><div class="line"></div><div class="line">						//localjarFile getEntry method</div><div class="line">						jmethodID methodID_getentry = env-&gt;GetMethodID(cls_JarFile,&quot;getEntry&quot;, &quot;(Ljava/lang/String;)Ljava/util/zip/ZipEntry;&quot;);</div><div class="line">						jobject LocalZipEntry = env-&gt;CallObjectMethod(localJarFile,methodID_getentry,jclassdex_jar);</div><div class="line">						//localjarFile getInputStream method</div><div class="line">						jmethodID methodID_getInputStream = env-&gt;GetMethodID(cls_JarFile,&quot;getInputStream&quot;, &quot;(Ljava/util/zip/ZipEntry;)Ljava/io/InputStream;&quot;);</div><div class="line">						jobject BufferinputstreamParam = env-&gt;CallObjectMethod(localJarFile,methodID_getInputStream,LocalZipEntry);</div><div class="line"></div><div class="line">						//new a File class</div><div class="line">						jclass cls_File = env-&gt;FindClass(&quot;java/io/File&quot;);</div><div class="line">						jmethodID methodID_File = env-&gt;GetMethodID(cls_File,&quot;&lt;init&gt;&quot;, &quot;(Ljava/lang/String;)V&quot;);</div><div class="line">						jobject localFile = env-&gt;NewObject(cls_File, methodID_File,jdestination);</div><div class="line"></div><div class="line">						//new  BufferedInputStream</div><div class="line">						jclass cls_BufferedInputStream = env-&gt;FindClass(&quot;java/io/BufferedInputStream&quot;);</div><div class="line">						jmethodID methodID_BufferedInputStream = env-&gt;GetMethodID(cls_BufferedInputStream,&quot;&lt;init&gt;&quot;, &quot;(Ljava/io/InputStream;)V&quot;);</div><div class="line">						jobject localBufferedInputStream = env-&gt;NewObject(cls_BufferedInputStream, methodID_BufferedInputStream,BufferinputstreamParam);</div><div class="line">						//new FileoutputStream</div><div class="line"></div><div class="line">						jclass cls_FileOutputStream = env-&gt;FindClass(&quot;java/io/FileOutputStream&quot;);</div><div class="line">						jmethodID methodID_FileOutputStream= env-&gt;GetMethodID(cls_FileOutputStream,&quot;&lt;init&gt;&quot;, &quot;(Ljava/io/File;)V&quot;);</div><div class="line">						jobject BufferoutputstreamParam = env-&gt;NewObject(cls_FileOutputStream, methodID_FileOutputStream,localFile);</div><div class="line"></div><div class="line">						//new BufferedOutputStream</div><div class="line">						jclass cls_BufferedOutputStream = env-&gt;FindClass(&quot;java/io/BufferedOutputStream&quot;);</div><div class="line">						jmethodID methodID_BufferedOutputStream = env-&gt;GetMethodID(cls_BufferedOutputStream,&quot;&lt;init&gt;&quot;, &quot;(Ljava/io/OutputStream;)V&quot;);</div><div class="line">						jobject localBufferedOutputStream = env-&gt;NewObject(cls_BufferedOutputStream, methodID_BufferedOutputStream,BufferoutputstreamParam);</div><div class="line">						//some preparations</div><div class="line">						jmethodID methodID_write = env-&gt;GetMethodID(cls_BufferedOutputStream,&quot;write&quot;, &quot;([BII)V&quot;);</div><div class="line">						jmethodID methodID_read = env-&gt;GetMethodID(cls_BufferedInputStream,&quot;read&quot;, &quot;([B)I&quot;);</div><div class="line">						jmethodID output_flush = env-&gt;GetMethodID(cls_BufferedOutputStream,&quot;flush&quot;, &quot;()V&quot;);</div><div class="line">						jmethodID output_close = env-&gt;GetMethodID(cls_BufferedOutputStream,&quot;close&quot;, &quot;()V&quot;);</div><div class="line">						jmethodID input_close = env-&gt;GetMethodID(cls_BufferedInputStream,&quot;close&quot;, &quot;()V&quot;);</div><div class="line"></div><div class="line">						while(true)&#123;</div><div class="line">							jint i =env-&gt;CallIntMethod(localBufferedInputStream,methodID_read,bytes);</div><div class="line">							LOGI(&quot;IIIIIIIIII %d&quot;,i);</div><div class="line">							if (i &lt;= 0)&#123;</div><div class="line">								env-&gt;CallVoidMethod(localBufferedOutputStream,output_flush);</div><div class="line">								env-&gt;CallVoidMethod(localBufferedOutputStream,output_close);</div><div class="line">								env-&gt;CallVoidMethod(localBufferedInputStream,input_close);</div><div class="line">								return;</div><div class="line">							&#125;</div><div class="line">							env-&gt;CallVoidMethod(localBufferedOutputStream,methodID_write,bytes,0,i);</div><div class="line">							LOGI(&quot;afterwrite %d&quot;,i);</div><div class="line"></div><div class="line">						&#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line">jstring   CharTojstring(JNIEnv*   env,   char*   str)</div><div class="line">&#123;</div><div class="line">    jsize   len   =   strlen(str);</div><div class="line"></div><div class="line">    jclass   clsstring   =   env-&gt;FindClass(&quot;java/lang/String&quot;);</div><div class="line">    jstring   strencode   =   env-&gt;NewStringUTF(&quot;GB2312&quot;);</div><div class="line"></div><div class="line">    jmethodID   mid   =   env-&gt;GetMethodID(clsstring,   &quot;&lt;init&gt;&quot;,   &quot;([BLjava/lang/String;)V&quot;);</div><div class="line">    jbyteArray   barr   =   env-&gt; NewByteArray(len);</div><div class="line"></div><div class="line">    env-&gt; SetByteArrayRegion(barr,0,len,(jbyte*)str);</div><div class="line">    return (jstring)env-&gt; NewObject(clsstring,mid,barr,strencode);</div><div class="line">&#125;</div><div class="line">jobject   getFieldOjbect(JNIEnv *env,</div><div class="line">		jstring class_name, jobject obj, jstring fieldName)</div><div class="line">&#123;</div><div class="line">			jclass context = env-&gt;FindClass(&quot;java/lang/Class&quot;);</div><div class="line">			jmethodID forName_func = env-&gt;GetStaticMethodID(context,&quot;forName&quot;,&quot;(Ljava/lang/String;)Ljava/lang/Class;&quot;);</div><div class="line">			jobject class_obj =	env-&gt;CallStaticObjectMethod(context, forName_func,class_name);</div><div class="line">			jclass class_java = env-&gt;GetObjectClass(class_obj);</div><div class="line"></div><div class="line">			jmethodID getField_func = env-&gt;GetMethodID(class_java,&quot;getDeclaredField&quot;,&quot;(Ljava/lang/String;)Ljava/lang/reflect/Field;&quot;);</div><div class="line">			jobject method_obj =env-&gt;CallObjectMethod(class_obj, getField_func,fieldName);</div><div class="line">			jclass class_method_obj= env-&gt;GetObjectClass(method_obj);</div><div class="line"></div><div class="line">			jmethodID setaccess_func = env-&gt;GetMethodID(class_method_obj,&quot;setAccessible&quot;,&quot;(Z)V&quot;);</div><div class="line">			env-&gt;CallVoidMethod(method_obj,setaccess_func,true);</div><div class="line"></div><div class="line">			jmethodID get_func = env-&gt;GetMethodID(class_method_obj,&quot;get&quot;,&quot;(Ljava/lang/Object;)Ljava/lang/Object;&quot;);</div><div class="line">			jobject get_obj =env-&gt;CallObjectMethod(method_obj,get_func,obj);</div><div class="line"></div><div class="line">			env-&gt;DeleteLocalRef(class_java);</div><div class="line">			env-&gt;DeleteLocalRef(method_obj);</div><div class="line">			return get_obj;</div><div class="line"></div><div class="line">&#125;</div><div class="line">jobject  invokeStaticMethodss (JNIEnv *env,jstring class_name, jstring method_name, jobjectArray pareTyple, jobjectArray pareVaules)</div><div class="line">&#123;</div><div class="line">		jclass context = env-&gt;FindClass(&quot;java/lang/Class&quot;);</div><div class="line">		jmethodID forName_func = env-&gt;GetStaticMethodID(context,&quot;forName&quot;,&quot;(Ljava/lang/String;)Ljava/lang/Class;&quot;);</div><div class="line">		jobject class_obj =	env-&gt;CallStaticObjectMethod(context, forName_func,class_name);</div><div class="line">		jclass class_java = env-&gt;GetObjectClass(class_obj);</div><div class="line"></div><div class="line">		jmethodID getMethod_func = env-&gt;GetMethodID(class_java,&quot;getMethod&quot;,&quot;(Ljava/lang/String;[Ljava/lang/Class;)Ljava/lang/reflect/Method;&quot;);</div><div class="line">		jobject method_obj =env-&gt;CallObjectMethod(class_obj, getMethod_func,method_name,pareTyple);</div><div class="line">		jclass class_method_obj= env-&gt;GetObjectClass(method_obj);</div><div class="line"></div><div class="line">		jmethodID invoke_func = env-&gt;GetMethodID(class_method_obj,&quot;invoke&quot;,&quot;(Ljava/lang/Object;[Ljava/lang/Object;)Ljava/lang/Object;&quot;);</div><div class="line">		jobject invoke_obj =env-&gt;CallObjectMethod(method_obj,invoke_func,NULL,pareVaules);</div><div class="line">		env-&gt;DeleteLocalRef(class_java);</div><div class="line">		env-&gt;DeleteLocalRef(method_obj);</div><div class="line">		return invoke_obj;</div><div class="line">&#125;</div><div class="line">void     setFieldOjbect(JNIEnv *env, jstring class_name, jstring fieldName, jobject obj, jobject filedVaule)</div><div class="line"></div><div class="line">&#123;</div><div class="line">				jclass context = env-&gt;FindClass(&quot;java/lang/Class&quot;);</div><div class="line">				jmethodID forName_func = env-&gt;GetStaticMethodID(context,&quot;forName&quot;,&quot;(Ljava/lang/String;)Ljava/lang/Class;&quot;);</div><div class="line">				jobject class_obj =	env-&gt;CallStaticObjectMethod(context, forName_func,class_name);</div><div class="line">				jclass class_java = env-&gt;GetObjectClass(class_obj);</div><div class="line"></div><div class="line">				jmethodID getField_func = env-&gt;GetMethodID(class_java,&quot;getDeclaredField&quot;,&quot;(Ljava/lang/String;)Ljava/lang/reflect/Field;&quot;);</div><div class="line">				jobject method_obj =env-&gt;CallObjectMethod(class_obj, getField_func,fieldName);</div><div class="line">				jclass class_method_obj= env-&gt;GetObjectClass(method_obj);</div><div class="line"></div><div class="line">				jmethodID setaccess_func = env-&gt;GetMethodID(class_method_obj,&quot;setAccessible&quot;,&quot;(Z)V&quot;);</div><div class="line">				env-&gt;CallVoidMethod(method_obj,setaccess_func,true);</div><div class="line"></div><div class="line">				jmethodID set_func = env-&gt;GetMethodID(class_method_obj,&quot;set&quot;,&quot;(Ljava/lang/Object;Ljava/lang/Object;)V&quot;);</div><div class="line">				env-&gt;CallVoidMethod(method_obj,set_func,obj,filedVaule);</div><div class="line"></div><div class="line">				env-&gt;DeleteLocalRef(class_java);</div><div class="line">				env-&gt;DeleteLocalRef(method_obj);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/07/27/三国kill字符串加密算法分析/">
  <time datetime="2015-07-26T16:06:00.000Z">
    2015-07-27
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/07/27/三国kill字符串加密算法分析/">三国kill字符串加密算法分析</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>三国kill字符串加密算法分析<br>【文章标题】:三国kill字符串加密算法<br>【文章作者】: Ericky<br>【作者博客】: <a href="http://blog.csdn.net/hk9259" target="_blank" rel="external">http://blog.csdn.net/hk9259</a><br>【下载地址】: 百度下载<br>【保护方式】: 字符串加密<br>【作者声明】: 本人水平有限，若有不足错误之处请各位大侠指正</p>
<h1 id="0x1-前言"><a href="#0x1-前言" class="headerlink" title="0x1 前言"></a>0x1 前言</h1><p>据说这款游戏的老版本是可以直接修改其中相应的字符串来进行狸猫换太子，从而绕过检验并且达到内购破解的效果，如今时隔一年，该游戏为了防止被篡改或者其他，加强了对自身的加密，尤其把一些关键字符串所保护，强度是否值得起时间的考验，我们来一探究竟。</p>
<h1 id="0x2-定位"><a href="#0x2-定位" class="headerlink" title="0x2 定位"></a>0x2 定位</h1><p>打开libgame.so，按照以前的思路，在浩瀚的字符串中找到加密的字符串如下：<br><img src="http://img.blog.csdn.net/20150727000248485" alt="这里写图片描述"><br>定位到红色框框中的类如下：<br><img src="http://img.blog.csdn.net/20150727000422666" alt="这里写图片描述"></p>
<h1 id="0x3-分析"><a href="#0x3-分析" class="headerlink" title="0x3 分析"></a>0x3 分析</h1><p>分析如图：<br><img src="http://img.blog.csdn.net/20150727000441589" alt="这里写图片描述"><br>继续向下分析：<br><img src="http://img.blog.csdn.net/20150727000350510" alt="这里写图片描述"><br>跟进后如下：<br><img src="http://img.blog.csdn.net/20150727000523647" alt="这里写图片描述"><br>Base64为标准的解密方式。<br>而下面的函数为Xor编码函数，不用管我们继续往下跟进：<br><img src="http://img.blog.csdn.net/20150727000429120" alt="这里写图片描述"><br>这里是一个循环解密，关键函数为70004C。<br>跟进去再继续跟来到SUB_7BE950这个函数：<br><img src="http://img.blog.csdn.net/20150727000603255" alt="这里写图片描述"><br>然后进行解密，解密出来的字符串用于so里面的调用。</p>
<h1 id="0x4-写解密加密程序"><a href="#0x4-写解密加密程序" class="headerlink" title="0x4 写解密加密程序"></a>0x4 写解密加密程序</h1><p>还原加密代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">//加密字符串 </div><div class="line">BYTE arry[] = &quot;classes.dea&quot;;</div><div class="line">//加密KEY</div><div class="line">const  uint32_t  Key  =  0x9f;</div><div class="line">//初始化</div><div class="line">unsigned char XorOut[100] =&quot;&quot;; </div><div class="line">char Base64Out[100]=&quot;&quot;;</div><div class="line">const  size_t  lens  =  sizeof(arry); </div><div class="line">for  (size_t  i  = 0  ;  i  &lt;  lens - 1;  i++)  &#123; </div><div class="line"></div><div class="line">	XorOut[i] = arry[i]  ^  (Key+i);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">base64_encode( XorOut, Base64Out, lens-1 );</div><div class="line"></div><div class="line">printf(&quot;%s\n&quot;,  Base64Out); </div><div class="line"></div><div class="line">char * base64_encode( const unsigned char * bindata, char * base64, int binlength )</div><div class="line">&#123;</div><div class="line">    int i, j;</div><div class="line">    unsigned char current;</div><div class="line"></div><div class="line">    for ( i = 0, j = 0 ; i &lt; binlength ; i += 3 )</div><div class="line">    &#123;</div><div class="line">        current = (bindata[i] &gt;&gt; 2) ;</div><div class="line">        current &amp;= (unsigned char)0x3F;</div><div class="line">        base64[j++] = base64char[(int)current];</div><div class="line"></div><div class="line">        current = ( (unsigned char)(bindata[i] &lt;&lt; 4 ) ) &amp; ( (unsigned char)0x30 ) ;</div><div class="line">        if ( i + 1 &gt;= binlength )</div><div class="line">        &#123;</div><div class="line">            base64[j++] = base64char[(int)current];</div><div class="line">            base64[j++] = &apos;=&apos;;</div><div class="line">            base64[j++] = &apos;=&apos;;</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">        current |= ( (unsigned char)(bindata[i+1] &gt;&gt; 4) ) &amp; ( (unsigned char) 0x0F );</div><div class="line">        base64[j++] = base64char[(int)current];</div><div class="line"></div><div class="line">        current = ( (unsigned char)(bindata[i+1] &lt;&lt; 2) ) &amp; ( (unsigned char)0x3C ) ;</div><div class="line">        if ( i + 2 &gt;= binlength )</div><div class="line">        &#123;</div><div class="line">            base64[j++] = base64char[(int)current];</div><div class="line">            base64[j++] = &apos;=&apos;;</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">        current |= ( (unsigned char)(bindata[i+2] &gt;&gt; 6) ) &amp; ( (unsigned char) 0x03 );</div><div class="line">        base64[j++] = base64char[(int)current];</div><div class="line"></div><div class="line">        current = ( (unsigned char)bindata[i+2] ) &amp; ( (unsigned char)0x3F ) ;</div><div class="line">        base64[j++] = base64char[(int)current];</div><div class="line">    &#125;</div><div class="line">    base64[j] = &apos;\0&apos;;</div><div class="line">    return base64;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>还原解密代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line">//*******************解密</div><div class="line">//KEY</div><div class="line">const  uint32_t Key2 = 0X9f;</div><div class="line">//解密字符串</div><div class="line">const char Base64In[]=&quot;7cXSzdbWxsPUhsbf3w==&quot;;</div><div class="line">const  size_t  lens2  =  (sizeof(Base64In)- 1)*3/4 -2;</div><div class="line">//Base64解密后存放</div><div class="line">unsigned char XorIn[] =&quot;&quot;; </div><div class="line">//Base64解密</div><div class="line">base64_decode( Base64In, XorIn);</div><div class="line">//Xor解密后存放</div><div class="line">char Base64Outd[100] = &quot;&quot;;</div><div class="line">//Xor解密</div><div class="line">for  (size_t  i  = 0  ;  i  &lt;  lens2;  i++)  &#123; </div><div class="line"></div><div class="line">	 Base64Outd[i] = XorIn[i]  ^  (Key2+i);</div><div class="line"></div><div class="line">&#125;</div><div class="line">printf(&quot;%s\n&quot;,  Base64Outd); </div><div class="line"></div><div class="line"></div><div class="line">int  base64_decode( const char * base64, unsigned char * bindata )</div><div class="line">&#123;</div><div class="line">    int i, j;</div><div class="line">    unsigned char k;</div><div class="line">    unsigned char temp[4];</div><div class="line">    for ( i = 0, j = 0; base64[i] != &apos;\0&apos; ; i += 4 )</div><div class="line">    &#123;</div><div class="line">        memset( temp, 0xFF, sizeof(temp) );</div><div class="line">        for ( k = 0 ; k &lt; 64 ; k ++ )</div><div class="line">        &#123;</div><div class="line">            if ( base64char[k] == base64[i] )</div><div class="line">                temp[0]= k;</div><div class="line">        &#125;</div><div class="line">        for ( k = 0 ; k &lt; 64 ; k ++ )</div><div class="line">        &#123;</div><div class="line">            if ( base64char[k] == base64[i+1] )</div><div class="line">                temp[1]= k;</div><div class="line">        &#125;</div><div class="line">        for ( k = 0 ; k &lt; 64 ; k ++ )</div><div class="line">        &#123;</div><div class="line">            if ( base64char[k] == base64[i+2] )</div><div class="line">                temp[2]= k;</div><div class="line">        &#125;</div><div class="line">        for ( k = 0 ; k &lt; 64 ; k ++ )</div><div class="line">        &#123;</div><div class="line">            if ( base64char[k] == base64[i+3] )</div><div class="line">                temp[3]= k;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        bindata[j++] = ((unsigned char)(((unsigned char)(temp[0] &lt;&lt; 2))&amp;0xFC)) |</div><div class="line">                ((unsigned char)((unsigned char)(temp[1]&gt;&gt;4)&amp;0x03));</div><div class="line">        if ( base64[i+2] == &apos;=&apos; )</div><div class="line">            break;</div><div class="line"></div><div class="line">        bindata[j++] = ((unsigned char)(((unsigned char)(temp[1] &lt;&lt; 4))&amp;0xF0)) |</div><div class="line">                ((unsigned char)((unsigned char)(temp[2]&gt;&gt;2)&amp;0x0F));</div><div class="line">        if ( base64[i+3] == &apos;=&apos; )</div><div class="line">            break;</div><div class="line"></div><div class="line">        bindata[j++] = ((unsigned char)(((unsigned char)(temp[2] &lt;&lt; 6))&amp;0xF0)) |</div><div class="line">                ((unsigned char)(temp[3]&amp;0x3F));</div><div class="line">    &#125;</div><div class="line">    return j;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="0x5-测试结果"><a href="#0x5-测试结果" class="headerlink" title="0x5 测试结果"></a>0x5 测试结果</h1><p><img src="http://img.blog.csdn.net/20150727000650289" alt="这里写图片描述"><br>7cXSzdbWxsPUhsbf3w==  ——–&gt; resources.out</p>
<p>88nDjcLWyMPGysCFx8XPyc7d1JzA2w==  ——–&gt; lib/armeabi/libgame.so</p>
<p>88nDjcLWyMPGysCH3ZvMgcPZ09XS2dCYxNc=  ——–&gt; lib/armeabi-v7a/libgame.so</p>
<p>/MzA0dDB1ojDzdE=   ——–&gt; classes.dex</p>
<h1 id="0x6-总结"><a href="#0x6-总结" class="headerlink" title="0x6 总结"></a>0x6 总结</h1><p>需要十足的耐心来分析算法，很锻炼人，睡觉。</p>
<p>2015.7.26<br>By Ericky</p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/07/25/Samp免流软件以及地铁跑酷的自校验分析/">
  <time datetime="2015-07-25T02:45:00.000Z">
    2015-07-25
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/07/25/Samp免流软件以及地铁跑酷的自校验分析/">Samp免流软件以及地铁跑酷的自校验分析</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>【文章标题】:Samp免流软件以及地铁跑酷的自校验分析<br>【文章作者】: Ericky<br>【作者博客】: <a href="http://blog.csdn.net/hk9259" target="_blank" rel="external">http://blog.csdn.net/hk9259</a><br>【下载地址】: 自行百度<br>【保护方式】: 自校验<br>【作者声明】: 本人水平有限，若有不足错误之处请指正</p>
<h1 id="0x1前言"><a href="#0x1前言" class="headerlink" title="0x1前言"></a>0x1前言</h1><p>群里讨论的两款软件的自校验，一开始有人说是签名校验，而且说找不到地方，下面就说一下我的拙见，若有错误之处，望各位大侠不吝指正</p>
<h1 id="0x2样本一"><a href="#0x2样本一" class="headerlink" title="0x2样本一"></a>0x2样本一</h1><h2 id="Samp免流软件–版本1-96"><a href="#Samp免流软件–版本1-96" class="headerlink" title="Samp免流软件–版本1.96"></a>Samp免流软件–版本1.96</h2><p>在Mainactivity中的Oncreate方法中可发现一些多的代码：<br><img src="http://img.blog.csdn.net/20150726103857521" alt="这里写图片描述"><br>删除上述两句，往下分析，发现所谓的“签名校验”实质如下：<br><img src="http://img.blog.csdn.net/20150726103911468" alt="这里写图片描述"><br>所谓的“签名校验”其实就是取了整个apk的大小，大小若改变了则判断为盗版APK，因此之需要奖之前的包大小return回去即可达到目的。<br>最后再删掉XML中的如下多余代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;meta-data android:name=&quot;BANGCLE_SDK_VERSION&quot; android:value=&quot;1005&quot; /&gt;         </div><div class="line">&lt;meta-data android:name=&quot;BANGCLE_APP_KEY&quot; android:value=&quot;web_194926&quot; /&gt;         </div><div class="line">&lt;receiver android:name=&quot;neo.proxy.DistributeReceiver&quot; android:exported=&quot;false&quot;&gt;             </div><div class="line">&lt;intent-filter&gt;                 &lt;action android:name=&quot;android.intent.action.ACTION_POWER_CONNECTED&quot; /&gt;                 </div><div class="line">&lt;action android:name=&quot;com.secneo.plugin.action.HOURLY&quot; /&gt;                 </div><div class="line">&lt;action android:name=&quot;com.secneo.plugin.action.DAILY&quot; /&gt;                 </div><div class="line">&lt;action android:name=&quot;com.secneo.plugin.action.APP_STARTED&quot; /&gt;                 </div><div class="line">&lt;action android:name=&quot;android.net.conn.CONNECTIVITY_CHANGE&quot; /&gt;                 </div><div class="line">&lt;action android:name=&quot;com.secneo.proxy.action.CUSTOM&quot; /&gt;             </div><div class="line">&lt;/intent-filter&gt;         </div><div class="line">&lt;/receiver&gt;         </div><div class="line">&lt;service android:name=&quot;neo.proxy.FastService&quot; android:exported=&quot;false&quot; /&gt;         </div><div class="line">&lt;activity android:theme=&quot;@android:style/Theme.Dialog&quot; android:name=&quot;neo.proxy.ToolActivity&quot; android:excludeFromRecents=&quot;true&quot; android:launchMode=&quot;singleInstance&quot; android:configChanges=&quot;keyboardHidden|orientation&quot;&gt;             </div><div class="line">&lt;intent-filter&gt;                 </div><div class="line">&lt;action android:name=&quot;com.secneo.proxy.action.CUSTOM&quot; /&gt;                 </div><div class="line">&lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;             </div><div class="line">&lt;/intent-filter&gt;         </div><div class="line">&lt;/activity&gt;</div></pre></td></tr></table></figure>
<p>BB加固的校验就完美去除，剩下的就是破解的事情了。</p>
<h1 id="0x3-样本二"><a href="#0x3-样本二" class="headerlink" title="0x3 样本二"></a>0x3 样本二</h1><h2 id="地铁跑酷游戏–版本2-34"><a href="#地铁跑酷游戏–版本2-34" class="headerlink" title="地铁跑酷游戏–版本2.34"></a>地铁跑酷游戏–版本2.34</h2><p>重打包后会出现如下提示：<br><img src="http://img.blog.csdn.net/20150726104229358" alt="这里写图片描述"></p>
<p>搜索后发现并不能搜到关键字，试着搜索一下”download”,便定位到了关键类如下：</p>
<p><img src="http://img.blog.csdn.net/20150726104211507" alt="这里写图片描述"><br>接下来的就是将所有fake引用值改为false即可完美绕过去了。一共有四处，其中一处如下：<br><img src="http://img.blog.csdn.net/20150726104237326" alt="这里写图片描述"></p>
<h1 id="0x4-总结"><a href="#0x4-总结" class="headerlink" title="0x4 总结"></a>0x4 总结</h1><p>去自校验定位很重要，而不仅仅是看别人的文章后学会搜Signature。因为自校验并不止签名一种方式，另一方面来说，绕过自校验也不一定需要知道检测签名的函数。<br>By Ericky<br>2015.7.25</p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/07/16/一枚Android拦截马简要分析/">
  <time datetime="2015-07-16T01:33:00.000Z">
    2015-07-16
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/07/16/一枚Android拦截马简要分析/">一枚Android拦截马简要分析</a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="一枚Android拦截马简要分析"><a href="#一枚Android拦截马简要分析" class="headerlink" title="一枚Android拦截马简要分析"></a>一枚Android拦截马简要分析</h1><p>【文章标题】:一枚Android拦截马简要分析<br>【文章作者】: Ericky<br>【作者博客】: <a href="http://blog.csdn.net/hk9259" target="_blank" rel="external">http://blog.csdn.net/hk9259</a><br>【下载地址】: 由于恶意程序，不提供下载<br>【保护方式】: 阿里加固<br>【作者声明】: 本人水平有限，若有不足错误之处请指正</p>
<h2 id="0x1-脱壳"><a href="#0x1-脱壳" class="headerlink" title="0x1 脱壳"></a>0x1 脱壳</h2><p>脱壳后包名结构如下：<br><img src="http://img.blog.csdn.net/20150717092809079" alt="这里写图片描述"></p>
<h2 id="0x2-获取内容"><a href="#0x2-获取内容" class="headerlink" title="0x2 获取内容"></a>0x2 获取内容</h2><p><img src="http://img.blog.csdn.net/20150717092834903" alt="这里写图片描述"><br>主要获取短信，联系人以及通话记录。</p>
<h2 id="0x3-混淆加密手法"><a href="#0x3-混淆加密手法" class="headerlink" title="0x3 混淆加密手法"></a>0x3 混淆加密手法</h2><p>利用大量的莫须有的Toast，诱使用户安装激活此木马：<br><img src="http://img.blog.csdn.net/20150717092854202" alt="这里写图片描述"><br>利用staker为字符串加密算法的密钥，对持有者的各种信息进行了加密：<br><img src="http://img.blog.csdn.net/20150717092911179" alt="这里写图片描述"></p>
<h2 id="0x4-解密关键信息"><a href="#0x4-解密关键信息" class="headerlink" title="0x4 解密关键信息"></a>0x4 解密关键信息</h2><p>此APK信息如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">接受短信号码：132XXXX5048</div><div class="line">发送邮箱帐号：m18221410034@163.com</div><div class="line">发送邮箱密码：bhrmlvzvtejsffor(已失效）</div><div class="line">接受邮箱帐号：m18221410034@163.com</div></pre></td></tr></table></figure>
<p>App使用时长：到<img src="http://img.blog.csdn.net/20150717092953956" alt="这里写图片描述">失效</p>
<h2 id="0x5-实验测试"><a href="#0x5-实验测试" class="headerlink" title="0x5 实验测试"></a>0x5 实验测试</h2><p>手机端远程控制端信息如下：<br><img src="http://img.blog.csdn.net/20150717093023213" alt="这里写图片描述"><br>邮箱截获短信，联系人等信息如下：<br><img src="http://img.blog.csdn.net/20150717093204442" alt="这里写图片描述"></p>
<h2 id="0x6-总结"><a href="#0x6-总结" class="headerlink" title="0x6 总结"></a>0x6 总结</h2><p>现在移动端支付以及各种app应用趋于成熟，但安全性这一块还很值得商榷。在如今这种得一手机得天下的时代，改木马危害性极其高。所有用户短信能被截获，导致用户无法收取正常短信，犯罪分子用其盗用用户的各种帐号密码，从而实现资金转账以及诈骗金钱的目的。<br>所以大家千万小心。</p>
<p>2015.07.16<br>Ericky</p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/07/14/一枚Android恶意锁屏程序分析/">
  <time datetime="2015-07-14T06:20:00.000Z">
    2015-07-14
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/07/14/一枚Android恶意锁屏程序分析/">一枚Android恶意锁屏程序分析</a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="一枚Android恶意锁屏程序分析"><a href="#一枚Android恶意锁屏程序分析" class="headerlink" title="一枚Android恶意锁屏程序分析"></a>一枚Android恶意锁屏程序分析</h1><p>【文章标题】:一枚Android恶意锁屏程序分析<br>【文章作者】: Ericky<br>【作者博客】: <a href="http://blog.csdn.net/hk9259" target="_blank" rel="external">http://blog.csdn.net/hk9259</a><br>【下载地址】: 由于恶意程序，不提供下载<br>【保护方式】: 无<br>【作者声明】: 本人水平有限，若有不足错误之处请指正</p>
<h2 id="0x1软件界面："><a href="#0x1软件界面：" class="headerlink" title="0x1软件界面："></a>0x1软件界面：</h2><p><img src="http://img.blog.csdn.net/20150714141732779" alt="这里写图片描述"><br><img src="http://img.blog.csdn.net/20150714141802482" alt="这里写图片描述"></p>
<h2 id="0x2分析"><a href="#0x2分析" class="headerlink" title="0x2分析"></a>0x2分析</h2><p>反编译APK后得到APK类文件目录如下：<br><img src="http://img.blog.csdn.net/20150714141830711" alt="这里写图片描述"><br>进入LockActivity定位到如下地方：<br><img src="http://img.blog.csdn.net/20150714141851282" alt="这里写图片描述"><br>图中红色部分就是重置你的手机开机密码了。<br>Mspmm就是设置的密码。<br>Jb解密函数如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public static String Descrption(String paramString, int paramInt)</div><div class="line">  &#123;</div><div class="line">    String str = &quot;&quot;;</div><div class="line">    String[] arrayOfString = paramString.split(&quot;2&quot;);</div><div class="line">    for (int i = 1; ; i++)</div><div class="line">    &#123;</div><div class="line">      if (i &gt;= arrayOfString.length)</div><div class="line">        return str;</div><div class="line">      str = str + (char)Integer.parseInt(arrayOfString[i], paramInt);</div><div class="line">    &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<p>得知真实的密码为：<br><img src="http://img.blog.csdn.net/20150714141921081" alt="这里写图片描述"><br>即可完成解锁。</p>
<h2 id="0x3总结"><a href="#0x3总结" class="headerlink" title="0x3总结"></a>0x3总结</h2><p>整体来说这个程序是比较简单的，如果要加强的话，应该设立N个分支，根据用户的行为（本例中可以根据用户选择的选项)来设置不同的密码，这样能加大静态分析的难度。但话说回来，这也只能坑小白类型的，其实只要连上电脑，清除手机的解锁密码还是很简单的事情。<br>By Erikcy<br>2015.7.14</p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/07/13/人工智能计算器AI Calculator 3.3.0 详细破解思路&教程/">
  <time datetime="2015-07-13T07:46:00.000Z">
    2015-07-13
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/07/13/人工智能计算器AI Calculator 3.3.0 详细破解思路&教程/">人工智能计算器AI Calculator 3.3.0 详细破解思路&amp;教程</a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="人工智能计算器AI-Calculator-3-3-0-详细破解思路-amp-教程"><a href="#人工智能计算器AI-Calculator-3-3-0-详细破解思路-amp-教程" class="headerlink" title="人工智能计算器AI Calculator 3.3.0 详细破解思路&amp;教程"></a>人工智能计算器AI Calculator 3.3.0 详细破解思路&amp;教程</h1><p>【文章标题】:人工智能计算器AI Calculator 3.3.0 详细破解思路&amp;教程<br>【文章作者】: Ericky<br>【作者邮箱】: hy_xiaoyu@126.com<br>【下载地址】: 附件附上<br>【保护方式】: 360加固<br>【作者声明】: 主要记录自己的学习过程!欢迎交流学习</p>
<h2 id="0x1脱壳"><a href="#0x1脱壳" class="headerlink" title="0x1脱壳"></a>0x1脱壳</h2><p>具体的脱壳去看看以前的一些文章，此篇文章主要讲破解部分，壳就略过了</p>
<h2 id="0x2破解"><a href="#0x2破解" class="headerlink" title="0x2破解"></a>0x2破解</h2><p>先安装程序，看看错误提示，所谓知己知彼百战不殆正是如此 如图所示:<br><img src="http://img.blog.csdn.net/20150713152836445" alt="这里写图片描述"><br>点击后会弹出授权失败的错误提示。<br>此时我想应该有很多同学会第一时间想到搜索字符串，既然这样，我们来搜索一下字符串如下，支付失败的字符串我们是搜索不到的，但是能搜到这个：<br><img src="http://img.blog.csdn.net/20150713152730263" alt="图片2"><br>这样就可以定位到package longbin.helloworld;中的hn类<br>hn类中一共有几个分支 一一来看一下：<br>分支1  –arg11.what == 111111的分支 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">if(arg11.what == 111111) &#123;</div><div class="line">            this.a.d.dismiss();</div><div class="line">            if(this.a.f) &#123;</div><div class="line">                v0 = this.a.getSharedPreferences(&quot;mySharedPreferences&quot;, 0).edit();</div><div class="line">                v0.putString(&quot;alipay_appid&quot;, m.e(this.a.p));</div><div class="line">                v0.commit();</div><div class="line">                v0 = PreferenceManager.getDefaultSharedPreferences(this.a).edit();</div><div class="line">                v0.putString(&quot;WWxoT2JnPT0=&quot;, hj.c(this.a.p));</div><div class="line">                v0.putBoolean(&quot;isDefaultTheme&quot;, true);</div><div class="line">                v0.putString(&quot;font_size&quot;, &quot;24&quot;);</div><div class="line">                v0.commit();</div><div class="line">                this.a.c.setEnabled(false);</div><div class="line">                new AlertDialog$Builder(this.a).setTitle(v2).setMessage(v4.getString(2131230970)).setPositiveButton(</div><div class="line">                        v4.getString(v9), new ho(this)).create().show();</div><div class="line">                return;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            v0 = PreferenceManager.getDefaultSharedPreferences(this.a).edit();</div><div class="line">            v0.putBoolean(&quot;isDefaultTheme&quot;, false);</div><div class="line">            v0.putString(&quot;font_size&quot;, &quot;28&quot;);</div><div class="line">            v0.commit();</div><div class="line">            new AlertDialog$Builder(this.a).setTitle(v2).setMessage(v4.getString(2131230972)).setPositiveButton(</div><div class="line">                    v9, new hp(this)).create().show();</div><div class="line">            return;</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<p>当启动程序后，进入授权页面点击按钮后Handler会处理这个分支</p>
<p>分支2  –arg11.what == 1001的分支 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line">if(arg11.what == 1001) &#123;</div><div class="line">            ik v5 = new ik(arg11.obj);</div><div class="line">            v5.a();</div><div class="line">            if(!v5.d) &#123;</div><div class="line">                return;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            if(this.a.p.equals(this.a.q)) &#123;</div><div class="line">                v0 = this.a.getSharedPreferences(&quot;mySharedPreferences&quot;, 0).edit();</div><div class="line">                v0.putString(&quot;alipay_appid&quot;, m.e(this.a.p));</div><div class="line">                v0.commit();</div><div class="line">                SharedPreferences$Editor v5_1 = PreferenceManager.getDefaultSharedPreferences(this.a)</div><div class="line">                        .edit();</div><div class="line">                v5_1.putString(&quot;WWxoT2JnPT0=&quot;, hj.c(this.a.p));</div><div class="line">                v5_1.putBoolean(&quot;isDefaultTheme&quot;, true);</div><div class="line">                v5_1.putString(&quot;font_size&quot;, &quot;24&quot;);</div><div class="line">                v5_1.commit();</div><div class="line">                this.a.c.setEnabled(false);</div><div class="line">                int v6 = Integer.valueOf(this.a.h[this.a.o]).intValue();</div><div class="line">                int v0_1 = v6 == 4 ? 1 : 0;</div><div class="line">                if(v6 == 8) &#123;</div><div class="line">                    v0_1 = 2;</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                SimpleDateFormat v3 = new SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;);</div><div class="line">                Date v1 = new Date();</div><div class="line">                String v6_1 = v3.format(v1);</div><div class="line">                if(this.a.r != null &amp;&amp; !&quot;&quot;.equals(this.a.r)) &#123;</div><div class="line">                    try &#123;</div><div class="line">                        v1 = v3.parse(this.a.r);</div><div class="line">                    &#125;</div><div class="line">                    catch(ParseException v1_1) &#123;</div><div class="line">                        v1_1.printStackTrace();</div><div class="line">                        v1 = ((Date)v2);</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    if(v1 != null) &#123;</div><div class="line">                        v1.setYear(v0_1 + v1.getYear());</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    this.a.r = v3.format(v1);</div><div class="line">                &#125;</div><div class="line">                else &#123;</div><div class="line">                    v1.setYear(v0_1 + v1.getYear());</div><div class="line">                    this.a.r = v3.format(v1);</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                v5_1.putString(&quot;V2xob2QyRllTbXhhUmprd1lWY3hiQT09&quot;, hj.c(this.a.r));</div><div class="line">                v5_1.commit();</div><div class="line">                new AlertDialog$Builder(this.a).setTitle(v2).setMessage(&quot;支付成功！授权已生效，您现在可使用付费功能了。\n您的付费时间为： &quot;</div><div class="line">                         + v6_1 + &quot;\n您的授权期限为： &quot; + this.a.r).setPositiveButton(v4.getString(v9), new </div><div class="line">                        hq(this)).create().show();</div><div class="line">                return;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            new AlertDialog$Builder(this.a).setTitle(v2).setMessage(v4.getString(2131230971)).setPositiveButton(</div><div class="line">                    v4.getString(v9), new hr(this)).create();</div><div class="line">            return;</div><div class="line">        &#125;</div></pre></td></tr></table></figure>
<p>这个就是付费成功的分支，经过对2个分支的对比，可以很清楚的看到以及知道这几句是功能恢复的关键代码：<br><img src="http://img.blog.csdn.net/20150713153021817" alt="这里写图片描述"><br>其中有个bool值this.a.f就是整个程序的关键。</p>
<p>可以在这里直接爆破给this.a.f 一个不等于0的值也能成功。<br>但是为了防止此值在其他地方也有调用，我们还是继续找源头。<br>找到PayActivity的authority按钮如下为this.c：<br><img src="http://img.blog.csdn.net/20150713153051403" alt="这里写图片描述"><br>这里对this.a.f 进行了赋值false，更加肯定了我们的判断<br>跟入ic类：<br><img src="http://img.blog.csdn.net/20150713153117649" alt="这里写图片描述"><br>如图，起了一个线程id类，继续跟进，在.class final Llongbin/helloworld/id 类增加一句    const v1, 0x1 达到对f的赋值：f其实就是IsPayUser.<br><img src="http://img.blog.csdn.net/20150713153136142" alt="这里写图片描述"><br>这里的SendEmptyMessage(111111)；也是与前面的分析相呼应。<br>这样的话，程序就被破解了。最重要的是流程大家都清楚了，不是糊里糊涂的碰对的，这才是提升水平的关键。</p>
<h2 id="0x3-过重启验证"><a href="#0x3-过重启验证" class="headerlink" title="0x3 过重启验证"></a>0x3 过重启验证</h2><p>既然重启验证，那就定位到HelloWorldActivity Class吧<br>一路往下找，到这里就比较可疑了：<br><img src="http://img.blog.csdn.net/20150713153200675" alt="这里写图片描述"><br>为什么说他可以，如果用心的人就可以知道，在前面破解分析的分支2里面的支付成功，也是取了时间的。这里就应该是取时间来判断是不是真正的注册了。或者说是用来验证用户的付费是不是过期了，恰好把一些破解变得不够完美了。</p>
<p>如果你没注意到这个时间，那也不要紧。这2句代码也足够了：<br>            this.cf.putBoolean(“isDefaultTheme”, false);<br>            this.cf.commit();<br>之前授权成功的时候执行的应该是这样的：<br>           this.cf.putBoolean(“isDefaultTheme”, true);<br>            this.cf.commit();<br>所以只要绕过这个地方就可以达到过重启验证的目的了。<br>方式就是启动这个类中的标签。当然 你也可以修改跳转，总之，达到目的就行了。</p>
<h2 id="0x4-去广告"><a href="#0x4-去广告" class="headerlink" title="0x4 去广告"></a>0x4 去广告</h2><p>删除androidmanifest.xml中的这几句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;meta-data android:name=&quot;UMENG_APPKEY&quot; android:value=&quot;541435b6fd98c50ae307da98&quot;/&gt;</div><div class="line">       &lt;meta-data android:name=&quot;UMENG_CHANNEL&quot; android:value=&quot;baidu&quot;/&gt;</div><div class="line">       &lt;meta-data android:name=&quot;COOLCHUAN_KEY&quot; android:value=&quot;e47a7d143004499ea30fd6a22146b59a&quot;/&gt;</div><div class="line"></div><div class="line">       &lt;service android:name=&quot;com.umeng.update.net.DownloadingService&quot; android:process=&quot;:DownloadingService&quot;/&gt;</div><div class="line">       &lt;activity android:name=&quot;com.umeng.update.UpdateDialogActivity&quot; android:theme=&quot;@android:style/Theme.Translucent.NoTitleBar&quot;/&gt;</div></pre></td></tr></table></figure>
<p>至此程序就完美破解了。<br>总结一下，破解程序应该修改越少越完美，既减少了你的工作量与出错率，又保证了程序功能的完整性。有的程序不难，但是需要你的耐心，认真破解一个比你随意破解多个更能提升你的实力。<br>2015.7.13<br>By Ericky</p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2015/03/24/百度脱壳的一点尝试--人肉修复/">
  <time datetime="2015-03-24T14:47:00.000Z">
    2015-03-24
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2015/03/24/百度脱壳的一点尝试--人肉修复/">百度脱壳的一点尝试--人肉修复</a></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近把研究dex的脱壳，顺便又是再次熟悉了一下dex的标准格式以及dex被解析后在内存中所存在的格式。自己上官网加了一个壳子，发现跑不起来。于是求助几个基友，最后样本是海总给的apk，很全面，带有Activity、Application、BroadcastReceiver、ContentProvider、以及Service。</p>
<h1 id="0x1-加壳前后对比"><a href="#0x1-加壳前后对比" class="headerlink" title="0x1    加壳前后对比"></a>0x1    加壳前后对比</h1><p><img src="http://img.blog.csdn.net/20150811223924860" alt="这里写图片描述"></p>
<p>加固后的文件列表变化:<br>新增一个so文件以及一个jar包：<br>libbaiduprotect.so<br>baiduprotect.jar<br>修改:<br>META-INF文件夹<br>AndroidManifest.xml<br>Classes.dex</p>
<h1 id="0x2-IDA尝试"><a href="#0x2-IDA尝试" class="headerlink" title="0x2    IDA尝试"></a>0x2    IDA尝试</h1><p>用IDA来远程调试，直接跑挂了。看来有反调试。<br>从壳入口Java层找到如下语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"> static &#123;</div><div class="line">        if(!Debug.isDebuggerConnected()) &#123;</div><div class="line">            String v0 = Build.CPU_ABI;</div><div class="line">            if(v0 != null &amp;&amp; (v0.startsWith(&quot;x86&quot;))) &#123;</div><div class="line">                StubApplication.loadX86Library();</div><div class="line">                return;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            System.loadLibrary(&quot;baiduprotect&quot;);</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>把第一个if删掉之后，程序顺利的加载了baiduprotect.so，顺利的进入了壳的领空，不过不知道是程序在so里面做了完整性校验还是再次检测了debuggerconnected，每次跑都是进入了一个死循环后，然后程序就跑挂了，跑了很多次都是难以逃出那个trap。这个时候就比较纠结了。既然反调试过不去，想起360的壳子用DD也可以脱的很完美，那就换个方式试试。</p>
<h1 id="0x3-DD大法"><a href="#0x3-DD大法" class="headerlink" title="0x3 DD大法"></a>0x3 DD大法</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dd if=/proc/PID/mem of=XX skip=0 ibs=1 count=LENGTH </div><div class="line">skip改成偏移地址</div><div class="line">偏移地址 </div><div class="line">cat /proc/pid/maps</div></pre></td></tr></table></figure>
<p>1.这里首先要感谢下wbyang博士猛男，这个DD大法也是上次挑战赛之后向他学来的。程序跑起来，把内存都dump出来，大概是100多mb的东西。找几个字符串，然后向上翻，找到dex文件的头，发现是被抹掉的。如图：<br><img src="http://img.blog.csdn.net/20150811224150817" alt="这里写图片描述"><br>前面红色框的8字节是odex的magic头。后面的0x70字节是dex的头。除了一些size和编码标志没有被抹掉，其他的已经是面目全非,修复后如下：<br><img src="http://img.blog.csdn.net/20150811224213172" alt="这里写图片描述"><br>这下把dex文件抠出来了。<br>2.把dex反编译成smali文件<br>出现如下错误：</p>
<p><img src="http://img.blog.csdn.net/20150811224352059" alt="这里写图片描述"></p>
<p>反复检查后发现了如下是CodeItems下面的offset错误：<br><img src="http://img.blog.csdn.net/20150811224405165" alt="这里写图片描述"><br>Dex的文件大小才0xA30DC，而offset指向了外面的东西。当然是无法解析的，这里我是有一个问题的，第三个偏移，这个0x0220E8E8，指向的是前面的内存，这是如何做到的？我个人认为是百度是在加载完成之后故意改成这个数字的。若有错误，还望前辈不吝指正。<br>把这三个offset 都改成0就可以达到反编译成功，当然是在缺三个DataItem的前提下编译成功的。找到被抹掉的DataItem地址：<br><img src="http://img.blog.csdn.net/20150811224427474" alt="这里写图片描述"></p>
<p>以上三处为0的区域就是加固前的dex代码所存放的位置。<br>因此，假设我们能从dex的结构逆推出该三处的数据并且用应该的数据填充这块，静态就能把这个壳子搞定了。<br>3.如何修复</p>
<p>360壳子要修复的数据为DataclassDef中的offset即可。而百度的更为麻烦一些，不仅它的偏移需要修复一下，更为麻烦的是DataItem的数据也要修复。这个难度就更大了。<br>总的修复原则是导出函数表，然后按顺序来修复dex中被抹掉的数据，如下：<br><img src="http://img.blog.csdn.net/20150811224456007" alt="这里写图片描述"></p>
<p>逆计算出函数的uleb128的索引值、常见函数的一些accessflags、以及指向函数内容的offset。<br>修复后如下：<br><img src="http://img.blog.csdn.net/20150811224512558" alt="这里写图片描述"></p>
<p>修复的过程比较繁琐，有时候还需要自己尝试几次才知道size是多少。所以叫它人肉修复好了。<br>修复好了反编译如图<br><img src="http://img.blog.csdn.net/20150811224535162" alt="这里写图片描述">：</p>
<p>发现onCreate函数没有代码，检查了一下，又有新发现！<br><img src="http://img.blog.csdn.net/20150811224551062" alt="这里写图片描述"></p>
<p>原来是oncreate中的insns[]也被抹掉了。这个算是最基本的单位了，功力太弱，无法逆推。</p>
<p>最后总结下，百度的壳子需要修复dex头中的magic、签名值、校验值以及各个offset。还需要修复Dataclassoffset，以及Dataclass和opcodes。前两者是可以静态修复的，最后的只能动态调试寻找了。百度壳子新增了一个oncreate001的函数，调用的壳中的d方法以及e方法，猜测是d方法填充了insns[]解密数据，然后e方法为清洁工，抹去正确的数据或者是改成一些非法数据。此时就泪奔了。。（心里暗想：百度好猥琐啊。。。）</p>
<p>由于过去几天了，再次写文章又重新做了一遍，把各种东西找好，写完花了将近三个小时，累觉不爱了。。。T T</p>
<p>由于水平有限，难免有错误，还望各位看官不吝指正。<br>2015.3.24 By Ericky</p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2014/12/29/写一个简单程序解析ELF/">
  <time datetime="2014-12-29T07:39:00.000Z">
    2014-12-29
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2014/12/29/写一个简单程序解析ELF/">写一个简单程序解析ELF</a></h1>
  

  </header>
  
  <div class="entry">
    
      <p>最近学习elf文件格式，感觉写一个程序会更印象深刻，牢固。于是便开工，程序很简单，写了3个part的，包括ELF_header，P_Header&amp;Section_Header，目前对ELF格式是很熟悉了，基本目的达到了。然后在写的过程中拿了一本elf的手册以及非虫的android elf格式附图。过程中发现了图中的两处错误，.interp段多框了一个字节，另外section name string table的偏移计算错了一个字节。<br>感觉这个时间点才学ELF主要是自娱自乐了。<br>不过还是要贴张图，也还是有成就感:<br><img src="http://img.blog.csdn.net/20150304154059144?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>附上源码，有想完善的就拿去吧，做一个Win下的readelf也是很nice的。</p>
<p>最后元旦快到了，那就祝大家度过一个心情无比开心，技术爆炸增长的元旦吧！<br>By Ericky<br>2014.12.29<br>源码见我上传的资源下载</p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  
    <article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2014/12/12/Dexguard6.X 最新解密脚本（for Strings）/">
  <time datetime="2014-12-12T07:06:08.000Z">
    2014-12-12
  </time>
</a>
    
    
  
    <h1 class="title"><a href="/2014/12/12/Dexguard6.X 最新解密脚本（for Strings）/">Dexguard6.X 最新解密脚本（for Strings）</a></h1>
  

  </header>
  
  <div class="entry">
    
      <h2 id="0x1-写这篇文字的目的："><a href="#0x1-写这篇文字的目的：" class="headerlink" title="0x1 写这篇文字的目的："></a>0x1 写这篇文字的目的：</h2><p>1、有一些人加我询问脚本的含义，这里都基本给了解答。<br>2、取之看雪，还之看雪。算是一种感恩吧。<br>菜鸟一枚，难免有错误冗长之处，失敬之处还望各位大侠多多包涵。</p>
<h2 id="0x2-用法"><a href="#0x2-用法" class="headerlink" title="0x2 用法:"></a>0x2 用法:</h2><p>打开脚本文件第一处：<br><img src="http://img.blog.csdn.net/20150324150638069?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>这里自己增加一些逻辑运算或者算数运算。之所以要这样，是因为JEB的包目前还不是很完善，具体的可以跟着代码到<a href="http://www.Android-decompiler.com/apidoc/" target="_blank" rel="external">http://www.Android-decompiler.com/apidoc/</a> 去看看，如果有更好的方法，也记得告诉我一声哦。<br>打开脚本文件第二处：<br><img src="http://img.blog.csdn.net/20150324150646670?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>这里更改成对于的加密字符串即可。<br>打开脚本文件第三处：<br><img src="http://img.blog.csdn.net/20150324150653191?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>这个函数里是针对你所要解密的函数中不同形式参数的逻辑判断，例如：</p>
<p>Call（arg1，arg2，arg3） 这种是早期的Dexguard的字符串解密函数调用形式</p>
<p>Call （arg1+Const，arg2，arg3[XX]）类似这种的在6.0较为普遍，同时又很多变种<br>打开脚本文件第四处：<br><img src="http://img.blog.csdn.net/20150324150700102?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"><br>这里是依据你的实际情况，写好你实际的解密逻辑和运算。（我 这里的提供的代码可以用于6.0）</p>
<h2 id="0x3-效果对比"><a href="#0x3-效果对比" class="headerlink" title="0x3 效果对比"></a>0x3 效果对比</h2><p>解密之前：<br><img src="http://img.blog.csdn.net/20150324150741561?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>解密之后：<br><img src="http://img.blog.csdn.net/20150324150714813?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></p>
<p>当然由于水平有限，会有少量bug，发现了bug请及时和我联系，我一定马上修改。</p>
<p>如果你觉得这篇文字很突然，你可以先看看 <a href="http://bbs.pediy.com/showthread.PHP?t=195423" target="_blank" rel="external">http://bbs.pediy.com/showthread.PHP?t=195423</a><br>如果还觉得突然，可以看看<a href="http://bbs.pediy.com/showthread.php?t=195202" target="_blank" rel="external">http://bbs.pediy.com/showthread.php?t=195202</a><br>如果还觉得突然，那你就应该去看那本白皮书了。<br>最后， 周五了，希望大家都能过一个轻松而愉快的周末！<br>这里是脚本下载：A script.zip.<br>By Ericky<br>2014.12.12 </p>

    
  </div>
  <footer class="end-sep">
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>


  

  <nav id="pagination">
  
    <a href="/" class="prev">Prev</a>
  
  
    <a href="/page/3/" class="next">Next</a>
  
  <div class="clearfix"></div>
</nav>

</div>
  </div>
  <footer id="footer"><div class="copyright">
  
  &copy; 2017 <a href="/">The darkness is no darkness with thee.</a>
  
</div>
<div class="theme-copyright">

</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="/js/scale.fix.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    $('.fancybox').fancybox();
  })(jQuery);
</script>

</body>
</html>