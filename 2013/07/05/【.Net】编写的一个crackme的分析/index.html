<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  
  <title>【.Net】编写的一个crackme的分析 | Ericky1992</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
    <meta name="author" content="The darkness is no darkness with thee.">
  
  
    <meta name="description" content="我们用.Net Reflector  载入
找到关键处  按钮事件：btn_ok_Click(Object, EventArgs) : Void
对于的关键代码如下：1234567891011121314151617181920Private Sub btn_ok_Click(ByVal sender As Object, ByVal e As EventArgs)      If (Me.tex">
  
  <meta name="description" content="我们用.Net Reflector  载入 找到关键处  按钮事件：btn_ok_Click(Object, EventArgs) : Void 对于的关键代码如下：1234567891011121314151617181920Private Sub btn_ok_Click(ByVal sender As Object, ByVal e As EventArgs)      If (Me.tex">
<meta name="keywords" content="安全 安卓 apk反编译 代码分析">
<meta property="og:type" content="article">
<meta property="og:title" content="【.Net】编写的一个crackme的分析">
<meta property="og:url" content="http://yoursite.com/2013/07/05/【.Net】编写的一个crackme的分析/index.html">
<meta property="og:site_name" content="Ericky1992">
<meta property="og:description" content="我们用.Net Reflector  载入 找到关键处  按钮事件：btn_ok_Click(Object, EventArgs) : Void 对于的关键代码如下：1234567891011121314151617181920Private Sub btn_ok_Click(ByVal sender As Object, ByVal e As EventArgs)      If (Me.tex">
<meta property="og:updated_time" content="2017-08-28T12:58:10.878Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【.Net】编写的一个crackme的分析">
<meta name="twitter:description" content="我们用.Net Reflector  载入 找到关键处  按钮事件：btn_ok_Click(Object, EventArgs) : Void 对于的关键代码如下：1234567891011121314151617181920Private Sub btn_ok_Click(ByVal sender As Object, ByVal e As EventArgs)      If (Me.tex">
  
  
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <div class="wrapper">
    <header id="header">
  <div class="title">
    <h1><a href="/">Ericky1992</a></h1>
    <p><a href="/">pursue ceaselessly</a></p>
  </div>
  <nav class="nav">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/">About</a></li>
      
      
    </ul>
    <div class="clearfix"></div>
  </nav>
  <div class="clearfix"></div>
</header>
    <div class="content"><article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2013/07/05/【.Net】编写的一个crackme的分析/">
  <time datetime="2013-07-05T00:38:00.000Z">
    2013-07-05
  </time>
</a>
    
    
  
    <h1 class="title">【.Net】编写的一个crackme的分析</h1>
  

  </header>
  
  <div class="entry">
    
      <p>我们用.Net Reflector  载入</p>
<p>找到关键处  按钮事件：<br>btn_ok_Click(Object, EventArgs) : Void</p>
<p>对于的关键代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">Private Sub btn_ok_Click(ByVal sender As Object, ByVal e As EventArgs)  </div><div class="line">    If (Me.textBox_Pass.Text = &quot;&quot;) Then  </div><div class="line">        MessageBox.Show(&quot;请输入密码!&quot;)  </div><div class="line">    Else  </div><div class="line">        Dim array As Char() = Me.textBox_Pass.Text.Replace(&quot;.&quot;, &quot;-&quot;).Replace(&quot;7&quot;, &quot;t&quot;).Replace(&quot;4&quot;, &quot;a&quot;).Replace(&quot;1&quot;, &quot;I&quot;).Replace(&quot;0&quot;, &quot;o&quot;).Replace(&quot;O&quot;, &quot;0&quot;).ToCharArray  </div><div class="line">        Array.Reverse(array)  </div><div class="line">        Dim s As New String(array)  </div><div class="line">        s.ToUpper  </div><div class="line">        Dim chArray2 As Char() = Convert.ToBase64String(Encoding.GetEncoding(&quot;UTF-8&quot;).GetBytes(s)).ToCharArray  </div><div class="line">        Array.Reverse(chArray2)  </div><div class="line">        Dim str2 As New String(chArray2)  </div><div class="line">        Dim str3 As New String(Convert.ToBase64String(Encoding.GetEncoding(&quot;UTF-8&quot;).GetBytes(str2)).ToCharArray)  </div><div class="line">        If (str3 = &quot;PTBpVGxSM1lqTWtVaE4yU0pOM1J2Qnph&quot;) Then  </div><div class="line">            MessageBox.Show(&quot;密码正确！密码就是Key!&quot;, &quot;成功&quot;)  </div><div class="line">        Else  </div><div class="line">            MessageBox.Show(&quot;密码错误!&quot;, &quot;失败&quot;)  </div><div class="line">        End If  </div><div class="line">    End If  </div><div class="line">  </div><div class="line">End Sub</div></pre></td></tr></table></figure></p>
<p>下面我们分析一下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">If (Me.textBox_Pass.Text = &quot;&quot;) Then  </div><div class="line">       MessageBox.Show(&quot;请输入密码!&quot;)  </div><div class="line">　Else</div></pre></td></tr></table></figure></p>
<p>为空则提示错误</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Dim array As Char() = Me.textBox_Pass.Text.Replace(&quot;.&quot;, &quot;-&quot;).Replace(&quot;7&quot;, &quot;t&quot;).Replace(&quot;4&quot;, &quot;a&quot;).Replace(&quot;1&quot;, &quot;I&quot;).Replace(&quot;0&quot;, &quot;o&quot;).Replace(&quot;O&quot;, &quot;0&quot;).ToCharArray</div></pre></td></tr></table></figure>
<p>将输入的字符串（key）中的“.”换成“-”，“7”换成“t”，“4”换成“a”，。。。等</p>
<p>Array.Reverse(array)</p>
<p>将替换过之后的序列号用Reverse()函数将一个字符串中最后一个字符放置到另一个字符串的第一个字符位置、倒数第二个字符放置在另一个字符串的第二个字符位置，以此类推。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Dim s As New String(array)  </div><div class="line">        s.ToUpper</div></pre></td></tr></table></figure></p>
<p>将array 给定义的变量S，将字符串首位变为大写<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">Dim chArray2 As Char() = Convert.ToBase64String(Encoding.GetEncoding(&quot;UTF-8&quot;).GetBytes(s)).ToCharArray  </div><div class="line">        Array.Reverse(chArray2)  </div><div class="line">        Dim str2 As New String(chArray2)  </div><div class="line">        Dim str3 As New String(Convert.ToBase64String(Encoding.GetEncoding(&quot;UTF-8&quot;).GetBytes(str2)).ToCharArray)  </div><div class="line"> If (str3 = &quot;PTBpVGxSM1lqTWtVaE4yU0pOM1J2Qnph&quot;) Then  </div><div class="line">            MessageBox.Show(&quot;密码正确！密码就是Key!&quot;, &quot;成功&quot;)  </div><div class="line">        Else  </div><div class="line">            MessageBox.Show(&quot;密码错误!&quot;, &quot;失败&quot;)  </div><div class="line">        End If  </div><div class="line">    End If  </div><div class="line">  </div><div class="line">End Sub</div></pre></td></tr></table></figure></p>
<p>将S字符串base64编码后 倒转 再经过base64编码，与固定字符串“PTBpVGxSM1lqTWtVaE4yU0pOM1J2Qnph”比较，同则注册成功。<br>分析了加密过程，我们可以逆向的来找注册码：</p>
<p>第一步：base64解码（“PTBpVGxSM1lqTWtVaE4yU0pOM1J2Qnph”）= “=0iTlR3YjMkUhN2SJN3RvBza”</p>
<p>第二步：Array.Reverse（“=0iTlR3YjMkUhN2SJN3RvBza”）=“azBvR3NJS2NhUkMjY3RlTi0=”</p>
<p>第三步：base64解码（“azBvR3NJS2NhUkMjY3RlTi0= ”）= “k0oGsIKcaRC#cteN-”</p>
<p>第四步：首字符变小写，即不变</p>
<p>第五步：Array.Reverse后替换：得到最后的注册码：<br>.Ne7c#CR4cK1sG0Ok</p>
<p>本文的三个函数附录：</p>
<p>Toupper：<br>功能：将字符转换为大写英文字母</p>
<p>Tolower：<br>功 能: 把字符转换成小写字母,非字母字符不做出处理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Array.Reverse  </div><div class="line">  </div><div class="line">public static string  ReverseByArray(this string  original)  </div><div class="line">&#123;  </div><div class="line">    char[] c = original.ToCharArray();  </div><div class="line">    Array.Reverse(c);  </div><div class="line">    return new string(c);  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

    
  </div>
  <footer>
    
      
  <div class="categories">
    <a class="categories-link" href="/categories/Windows/">Windows</a>
  </div>

      
  <div class="tags">
    <a class="tags-link" href="/tags/安全-安卓-apk反编译-代码分析/">安全 安卓 apk反编译 代码分析</a>
  </div>

    
    <div class="clearfix"></div>
  </footer>
</article>

</div>
  </div>
  <footer id="footer"><div class="copyright">
  
  &copy; 2017 <a href="/">The darkness is no darkness with thee.</a>
  
</div>
<div class="theme-copyright">

</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="/js/scale.fix.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    $('.fancybox').fancybox();
  })(jQuery);
</script>

</body>
</html>