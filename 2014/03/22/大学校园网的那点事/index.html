<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  
  <title>大学校园网的那点事 | Ericky1992</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
    <meta name="author" content="The darkness is no darkness with thee.">
  
  
    <meta name="description" content="前言  关于数字XX高校，我的几点看法正如孔子所说，“逝者如斯夫，不舍昼夜！”时间如流水落花般逝去，二十二的年龄，毕业的季节。大四下，我会好好欣赏XX高校的各式风景。

好了，感慨不多发了，我们进入正题。写这篇文章的主要目的是分析一下数字XX高校的不足之处，好让这个系统能够更加完美。当然，有则改之，无则加勉。其实，在刚发这个校园卡上网的时候，见着6位数字的默认密码，我就曾大胆的猜测过，用穷举法不就">
  
  <meta name="description" content="前言  关于数字XX高校，我的几点看法正如孔子所说，“逝者如斯夫，不舍昼夜！”时间如流水落花般逝去，二十二的年龄，毕业的季节。大四下，我会好好欣赏XX高校的各式风景。  好了，感慨不多发了，我们进入正题。写这篇文章的主要目的是分析一下数字XX高校的不足之处，好让这个系统能够更加完美。当然，有则改之，无则加勉。其实，在刚发这个校园卡上网的时候，见着6位数字的默认密码，我就曾大胆的猜测过，用穷举法不就">
<meta name="keywords" content="验证码 解密 破解 源码 安全">
<meta property="og:type" content="article">
<meta property="og:title" content="大学校园网的那点事">
<meta property="og:url" content="http://yoursite.com/2014/03/22/大学校园网的那点事/index.html">
<meta property="og:site_name" content="Ericky1992">
<meta property="og:description" content="前言  关于数字XX高校，我的几点看法正如孔子所说，“逝者如斯夫，不舍昼夜！”时间如流水落花般逝去，二十二的年龄，毕业的季节。大四下，我会好好欣赏XX高校的各式风景。  好了，感慨不多发了，我们进入正题。写这篇文章的主要目的是分析一下数字XX高校的不足之处，好让这个系统能够更加完美。当然，有则改之，无则加勉。其实，在刚发这个校园卡上网的时候，见着6位数字的默认密码，我就曾大胆的猜测过，用穷举法不就">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230332393?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230401066?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230345578?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230415875?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230523013?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230517703?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230724288?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230711968?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230815815?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230912396?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://img.blog.csdn.net/20150127230931781?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:updated_time" content="2017-08-28T13:01:52.669Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="大学校园网的那点事">
<meta name="twitter:description" content="前言  关于数字XX高校，我的几点看法正如孔子所说，“逝者如斯夫，不舍昼夜！”时间如流水落花般逝去，二十二的年龄，毕业的季节。大四下，我会好好欣赏XX高校的各式风景。  好了，感慨不多发了，我们进入正题。写这篇文章的主要目的是分析一下数字XX高校的不足之处，好让这个系统能够更加完美。当然，有则改之，无则加勉。其实，在刚发这个校园卡上网的时候，见着6位数字的默认密码，我就曾大胆的猜测过，用穷举法不就">
<meta name="twitter:image" content="http://img.blog.csdn.net/20150127230332393?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
  
  
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <div class="wrapper">
    <header id="header">
  <div class="title">
    <h1><a href="/">Ericky1992</a></h1>
    <p><a href="/">pursue ceaselessly</a></p>
  </div>
  <nav class="nav">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/">About</a></li>
      
      
    </ul>
    <div class="clearfix"></div>
  </nav>
  <div class="clearfix"></div>
</header>
    <div class="content"><article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2014/03/22/大学校园网的那点事/">
  <time datetime="2014-03-22T15:01:00.000Z">
    2014-03-22
  </time>
</a>
    
    
  
    <h1 class="title">大学校园网的那点事</h1>
  

  </header>
  
  <div class="entry">
    
      <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>  关于数字XX高校，我的几点看法<br>正如孔子所说，“逝者如斯夫，不舍昼夜！”时间如流水落花般逝去，二十二的年龄，毕业的季节。大四下，我会好好欣赏XX高校的各式风景。</p>
<hr>
<p>好了，感慨不多发了，我们进入正题。写这篇文章的主要目的是分析一下数字XX高校的不足之处，好让这个系统能够更加完美。当然，有则改之，无则加勉。<br>其实，在刚发这个校园卡上网的时候，见着6位数字的默认密码，我就曾大胆的猜测过，用穷举法不就能登录别人的帐号吗？对，就是一个一个试，当然不是靠我们人来手工操作，<br>6位数字的密码，共100万个，人工输入尝试当然是不可取的。但是写程序呢？那又会怎么样呢？</p>
<hr>
<h2 id="一、暴力密码拆解程序的实现。"><a href="#一、暴力密码拆解程序的实现。" class="headerlink" title="一、暴力密码拆解程序的实现。"></a>一、暴力密码拆解程序的实现。</h2><p><img src="http://img.blog.csdn.net/20150127230332393?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>
<p>这是登录界面，校内网的同学就能看到，地址：<a href="http://61.137.86.87:8080/portalNat444/index.jsp" target="_blank" rel="external">http://61.137.86.87:8080/portalNat444/index.jsp</a></p>
<p>我们平常登录是输入帐号密码，点击登陆按钮进行登录，这就是说明我们给服务端发送了一个数据，服务端接收到我们的数据然后判断帐号密码的正确性，最后给我们正确的响应。<br>我们要用的是：<br>网页封包抓取—-&gt;即我们要知道计算机向服务端到底发送了什么样的数据包，便能依瓢画葫芦，直接实现数据包尝试登录。<br>抓包的工具很多，如果你还在用Httpwatch的话，我可以告诉你，你没有跟上潮流。Httpwatch固然老牌，但是貌似在64位系统下不兼容。这里我用的是Wireshark，一款相当nice的抓包工具，当然如果你是Firefox浏览器的话，可以直接用自带的debug。<br><img src="http://img.blog.csdn.net/20150127230401066?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>
<p>具体操作可以百度Wireshark的user manual，我这里不多加阐述。</p>
<p>根据Wireshark抓包，可以知道抓到的包是POST 类型的，当然在网页的源码里也能找到<br><img src="http://img.blog.csdn.net/20150127230345578?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>
<p>当然，后面的便是date.resultCode为0时，就登录成功，如果你能成功控制服务器，把resultCode设置成0，则会永远登录成功，显然这是不明智的。</p>
<p>回归正题，我们需要发送的post数据包为:<br>网址：<a href="http://61.137.86.87:8080/portalNat444/AccessServices/login" target="_blank" rel="external">http://61.137.86.87:8080/portalNat444/AccessServices/login</a><br>方式：POST<br>数据内容：<br>accountID=010103100527%40zndx.inter   //这里的%40 代表的是@<br>&amp;password=56aad664fa33bffb42b2c0be23ebc5efce17d7f82c0d75ade387941c690063382fef34369b1d7c929945fdbd4ba28bc77db7b028d022464646165acedf2b5deb2ce1fb3d4dc074c55888e299d384af306572a368f468d88fdafdaefebfa39bf84fad0530775d37f35dc79594ba62be4fc5189544397ed97054f4fc375903b6<br>&amp;brasAddress=59df7586<br>&amp;userIntranetAddress=10.96.85.80<br>我们可以看到，一共发送给了服务器4个参数：<br>第一个参数accountID：（学号加上@zndx.inter）<br>第二个参数password：顾名思义，这是密码。不过并不是我们所期待的6位数字，这是因为他经过了处理，加密了，加密算法为RSA1024bit，这个算法后面会讲到。<br>第三个参数brasAddress：我这里是59df7586，应该是本机的物理特征，多抓取了几个封包，发现这个不变，就不必管它了，不影响我们工作。<br>第四个参数userIntranetAddress：这是本机内网IP，我们可以在cmd中输入ipconfig/all或者ipconfig进行查看：<br><img src="http://img.blog.csdn.net/20150127230415875?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>
<p>也可以写一个小程序遍历本机的ip地址。</p>
<p>这是我写的一个小程序：<br><img src="http://img.blog.csdn.net/20150127230523013?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>
<p>也可以用C++：<br><img src="http://img.blog.csdn.net/20150127230517703?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>
<p>程序C++源码如下：<br>‘’’</p>
<p>#include <stdio.h>   </stdio.h></p>
<p>#include <winsock2.h>   </winsock2.h></p>
<p>#pragma comment(lib,”ws2_32.lib”)   </p>
<p>int doit(int, char **)<br>{<br>char host_name[255];<br>//获取本地主机名称<br>if (gethostname(host_name, sizeof(host_name)) == SOCKET_ERROR) {<br>printf(“Error %d when getting local host name.\n”, WSAGetLastError());<br>return 1;<br>}<br>printf(“Host name is: %s\n”, host_name);   </p>
<p>//从主机名数据库中得到对应的“主机”<br>struct hostent *phe = gethostbyname(host_name);<br>if (phe == 0) {<br>printf(“Yow! Bad host lookup.”);<br>return 1;<br>}   </p>
<p>//循环得出本地机器所有IP地址<br>for (int i = 0; phe-&gt;h_addr_list[i] != 0; ++i) {<br>struct in_addr addr;<br>memcpy(&amp;addr, phe-&gt;h_addr_list[i], sizeof(struct in_addr));<br>printf(“IPAddress %d : %s\n” , i, inet_ntoa(addr));<br>}<br>printf(“如果有10.96的IP address，则说明此Ip为本机Ipv4地址<strong><strong><strong><strong>**</strong></strong></strong></strong>  \n” );<br>printf(“如果无10.96的IP address，则说明计算机未连通校园网<strong><strong><strong><strong>**</strong></strong></strong></strong>  \n” );<br>return 0;<br>}   </p>
<p>int main(int argc, char *argv[])<br>{<br>WSAData wsaData;<br>if (WSAStartup(MAKEWORD(1, 1), &amp;wsaData) != 0) {<br>return 255;<br>}   </p>
<p>int retval = doit(argc, argv);   </p>
<p>WSACleanup();   </p>
<p>return retval;<br>}<br>‘’’<br>好了，一共4个参数，我们解决了3个，头痛的是第二个被加密的密码是如何由6位数字转换成256位的加密后的字符串的。</p>
<p>256位的加密字符串很容易让人联想到RSA1024加密，这是一种单向加密，多用于商业用途，强度取决于对大数的因式分解。具体可以到维基百科看。<br>这种过高的加密强度使得我望而却步。<br>正要放弃，却发现了一个致命的弱点，有一个security.js的文件又再给人一线希望。将源文件下载到本地，分析后就知道了由6位数字如何魔术般成为了256位字符。<br>一共有这么几个文件：<br><img src="http://img.blog.csdn.net/20150127230724288?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>
<p>我们打开security.js，可以发现，我们的猜测并没有错：<br><img src="http://img.blog.csdn.net/20150127230711968?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>
<p>一共700行代码，不一一贴出</p>
<hr>
<p>无论是注解还是函数名称，都证明了是RSA1024无疑。可笑的是，这个代码是05年写的，10年经过修改。并且在调试过程中，我发现了供应商是华为，无疑。<br><img src="http://img.blog.csdn.net/20150127230815815?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>
<p>既然有了源码，我们也能发现这和我们抓包所得到的数据一致，只是密码用了一个函数encodeURIComponent（）函数进行编码后再用security.js里写好的RSA加密算法进行加密。</p>
<p>搞定了POST的四个参数，用一个循环和100万个密码进行暴力破解，也就能实现用别人的一个已知的学号（默认密码）进行登录。</p>
<h2 id="二、暴力破解的效率"><a href="#二、暴力破解的效率" class="headerlink" title="二、暴力破解的效率"></a>二、暴力破解的效率</h2><p>百度网盘曾经有段时间是4位数字密码，即1万个数字，即使算最后一次才尝试成功，也在10分钟以内。我们就按这个概率算，当然，你可以计算时间的期望值如果你的概率论学得不错。就算10分钟，1000分钟也能尝试出一个密码，约16个小时。是不是很nice，按期望的话，平均9小时就差不多能得到一个帐号的密码。<br>当然官方不是吃素的，他当然会考虑到这个可能性。</p>
<h2 id="三、官方限制"><a href="#三、官方限制" class="headerlink" title="三、官方限制"></a>三、官方限制</h2><p>可能考虑到有人会尝试穷举所有密码，或是因为代码的严谨性，jQuery-timers.1.2.js这个文件里的内容就是来限制大家的次数，我大概尝试了下，1个帐号连续输错10次密码后会提示错误信息“无法获取”，大约停止3分钟。如果按照这个官方设计好的方式来算，10次密码耗时3分钟，100万次耗时30万分钟，约208天的时间，当然，就不存在穷举来窃取他人帐号，因为没有人愿意发大半年时间就破解一个密码，可能还不够交电费。那我们就放弃吗？<br>Of course not！尽管它是限制了次数，我们可以用一种巧妙的方法躲过，方法很简单：我们可以尝试010103100101的密码10次，一直到无法获取，开始尝试2号学号的10次，这样我们电脑的效率能实现最大化，概率当然不变，还是9小时左右能拿到一个号。<br>我还发现，代码里存在一个登录标志，这使得多线程无法得以实现。不过不怕，每个寝室不是你一个人在战斗，跟他们说清情况，结果可想而知，你懂的。</p>
<h2 id="四、优化"><a href="#四、优化" class="headerlink" title="四、优化"></a>四、优化</h2><p>100万次的次数太多，为了使得尝试次数减少，我向同学要了大概10个左右的密码，基本可以剔除6位数字里全相同的，5个数字相同的以及4个数字相同的密码。<br>这样的密码可以不用尝试：<br>11111；22222；11115；344445；863888；<br>用排列组合，我们可以算出，剔除了以上几种可能后，密码的尝试次数将减少到746640次，这样的话，时间又能缩短了。当然，你还可以去除一些123456；765432；这样的密码，具体可以参考双色球的一些软件的算法。这里不做赘述。</p>
<h2 id="五、其他"><a href="#五、其他" class="headerlink" title="五、其他"></a>五、其他</h2><p>除了温柔的暴力拆解密码以外，当然可以采取直接的入侵手段，那样便会方便很多，当然完成后记得删除telnet 和http等日志。</p>
<p>总的来说，数字XX高校还是设计得不够完善。<br>提出几点建议如下：<br>1.大家不要嫌麻烦，建议改下密码，6位数字并不安全。<br>2.数字XX高校应把源码藏好，不能让外面轻易得到，这点是很值得改善的。<br>3.源代码里的验证码都被注释了起来：</p>
<p><img src="http://img.blog.csdn.net/20150127230912396?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>
<p>图一：jsp中的<br>Js中的validateCode 也全部不再使用，尽管提高了学生上网的方便，同时也使得帐号的安全性下降了。</p>
<h2 id="4-其他的就是网络攻防了，这就看管理员的水平了。"><a href="#4-其他的就是网络攻防了，这就看管理员的水平了。" class="headerlink" title="4.其他的就是网络攻防了，这就看管理员的水平了。"></a>4.其他的就是网络攻防了，这就看管理员的水平了。</h2><h2 id="声明：本人水平有限，若有不正确之处，还望各位大侠指正。"><a href="#声明：本人水平有限，若有不正确之处，还望各位大侠指正。" class="headerlink" title="声明：本人水平有限，若有不正确之处，还望各位大侠指正。"></a>声明：本人水平有限，若有不正确之处，还望各位大侠指正。</h2><pre><code>     Ericky
2014年03月22日
</code></pre><p>附录一：公钥定义处</p>
<p><img src="http://img.blog.csdn.net/20150127230931781?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvaGs5MjU5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="这里写图片描述"></p>

    
  </div>
  <footer>
    
      
  <div class="categories">
    <a class="categories-link" href="/categories/Windows/">Windows</a>
  </div>

      
  <div class="tags">
    <a class="tags-link" href="/tags/验证码-解密-破解-源码-安全/">验证码 解密 破解 源码 安全</a>
  </div>

    
    <div class="clearfix"></div>
  </footer>
</article>

</div>
  </div>
  <footer id="footer"><div class="copyright">
  
  &copy; 2017 <a href="/">The darkness is no darkness with thee.</a>
  
</div>
<div class="theme-copyright">

</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="/js/scale.fix.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    $('.fancybox').fancybox();
  })(jQuery);
</script>

</body>
</html>